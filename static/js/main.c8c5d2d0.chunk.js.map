{"version":3,"sources":["util/Subject.js","util/NodeManager.js","util/Graph.js","util/Network.js","hooks/useEvent.js","components/SystemsGraph/SystemsGraph.js","util/FileManager.js","components/CommandBar/CommandBar.js","components/SystemForm/ConnectionReadWrite.js","components/SystemForm/Connection.js","components/SystemForm/SystemType.js","components/SystemForm/SystemFormView.js","components/SystemForm/SystemForm.js","components/NodeDetail/NodeDetailView.js","components/NodeDetail/NodeDetail.js","components/Loading/Loading.js","App.js","index.js"],"names":["_handlers","Subject","subscribe","event","handler","push","unsubscribe","filter","func","next","_len","arguments","length","args","Array","_key","forEach","apply","Object","freeze","NodeManager","_get","key","defaultValue","JSON","parse","localStorage","getItem","_set","value","setItem","stringify","getEdges","getNodesObject","saveUploadedData","_ref","edges","nodes","getNodes","keys","reduce","acc","cur","_NodeManager","Graph","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","abrupt","stop","this","_ref2","_callee2","_context2","setEdges","_ref3","_callee3","_context3","_x","setNodes","_ref4","_callee4","_context4","_x2","addNode","_ref5","_callee5","node","_nodes","_context5","id","Error","sent","makeEdges","_x3","addEdge","_ref6","_callee6","node1","node2","data","_edges","_context6","isArray","addDirectedEdge","_x4","_x5","_x6","_ref7","_callee7","node2TargetID","_context7","findIndex","_ref8","objectSpread","_x7","_x8","_x9","removeDirectedEdge","_ref9","_callee8","_context8","_ref10","_x10","_x11","removeEdge","_ref11","_callee9","_context9","_ref12","_ref13","_x12","_x13","makeNode","_ref15","_callee10","_ref14","connections","connectionKeys","previousEdges","removeEdges","_context10","map","item","uuid","get","edge","index","remove","splice","info","concat","type","read","write","existingEdgeIndex","label","text","_x14","_ref16","_callee11","_loop","i","cleanup","_context12","prevEdge","_context11","find","_ref17","delegateYield","differenceby","_x15","_Graph","Network","_options","_container","_network","makeData","DataSet","builder","withEdges","withNodes","withOptions","options","inContainer","element","build","VisNetwork","network","setData","_Network","useEvent","useEffect","systemsReducer","state","action","buildGraphData","getLinkColor","graphData","size","widthConstraint","minimum","maximum","shape","getShape","name","shadow","enabled","x","y","color","nodeId","from","to","hover","dashes","arrows","SystemsGraph","_useReducer","useReducer","_useReducer2","slicedToArray","systems","systemsDispatch","_useState","useState","_useState2","activeNode","setActiveNode","graphContainer","useRef","graph","displayNodeDetails","handleRightClick","useCallback","current","getNodeAt","pointer","DOM","isCluster","openCluster","matchingNode","clusterByConnection","clusterNodeProperties","handleNodeSelect","params","off","on","systemGraph","autoResize","interaction","hoverConnectedEdges","document","addEventListener","e","preventDefault","react_default","createElement","style","overflow","flex","ref","handleFile","reader","FileReader","readAsBinaryString","target","files","onloadend","result","CommandBar","props","items","iconProps","iconName","onClick","setAttribute","display","click","uploadFile","filename","encodeURIComponent","dayjs","format","body","appendChild","removeChild","downloadFile","position","top","left","right","CommandBar_CommandBar","canChange","nextPath","nextValue","currentRead","currentWrite","ConnectionReadWrite","onChange","Stack","marginRight","marginTop","verticalAlign","tokens","childrenGap","Checkbox","checked","ConnectionContainer","styled","div","_templateObject","Connection","handleRemove","edit","addNodeForm","nodeFormErrors","setNodeFormErrors","existingSystems","updateNodeForm","selectedTarget","selectedType","selectedRead","selectedWrite","targetError","typeError","path","IconButton","Dropdown","placeholder","errorMessage","selectedKey","errors","ConnectionReadWrite_ConnectionReadWrite","SystemType","React","memo","required","prevProps","nextProps","keysUnchanged","errorUnchanged","SystemFormView","addConnection","Fragment","TextField","onGetErrorMessage","newSystem","String","toLowerCase","some","department","url","URL","err","message","checkURL","multiline","rows","description","conn","cloneElement","renderConnections","ActionButton","makeConnections","system","connectionType","connectedTo","addNodeReducer","addNodeState","unset","formState","set","connectionReducer","toConsumableArray","Connection_Connection","dispatch","getSystems","validate","SystemForm","setEdit","_useState3","_useState4","isOpen","setIsOpen","_useState5","_useState6","setExistingSystems","_useState7","_useState8","_useReducer3","_useReducer4","connDispatch","resetForm","resetConnections","_Network$build","getConnectedNodes","connectedNodes","includes","makeFormState","submitSystem","_node","broadcastNodeSave","dismiss","Panel","headerText","onDismiss","isFooterAtBottom","onRenderFooterContent","horizontal","horizontalAlign","DefaultButton","PrimaryButton","PanelType","medium","SystemFormView_SystemFormView","NodeDetailView","Text","textDecoration","variant","href","CustomPanel","NodeDetail_templateObject","readWriteStatus","NodeDetail","setNode","editSystem","deselectActiveNode","NodeDetail_Connection","parseConnections","handleEdit","onRenderHeader","marginLeft","marginBottom","isLightDismiss","customNear","customWidth","NodeDetail_NodeDetailView","cubeMove","keyframes","Loading_templateObject","cubeCSS","_templateObject2","css","_templateObject3","_templateObject4","_templateObject5","Page","App_templateObject","App","SystemsGraph_SystemsGraph","CommandBar_CommandBar_CommandBar","SystemForm_SystemForm","NodeDetail_NodeDetail","initializeIcons","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.c8c5d2d0.chunk.js","sourcesContent":["const _handlers = {}\n\nexport const Subject = {\n  subscribe (event, handler) {\n    if (!_handlers[event]) _handlers[event] = []\n    _handlers[event].push(handler)\n  },\n  unsubscribe (event, handler) {\n    if (!_handlers[event]) return\n    _handlers[event] = _handlers[event].filter(func => func !== handler)\n  },\n  next (event, ...args) {\n    if (!_handlers[event]) return\n    _handlers[event].forEach(handler => {\n      if (typeof handler === 'function') {\n        handler(...args)\n      }\n    })\n  }\n}\n\nObject.freeze(Subject)\n","const _NodeManager = () => {\n  const _get = (key, defaultValue) => JSON.parse(localStorage.getItem(key)) || defaultValue\n  const _set = (key, value) => localStorage.setItem(key, JSON.stringify(value))\n  const getNodesObject = () => {\n    return _get('_nodes', {})\n  }\n\n  const getNodes = () => {\n    const nodes = _get('_nodes', {})\n    const nodeKeys = Object.keys(nodes)\n\n    return nodeKeys.reduce((acc, cur) => {\n      acc.push(nodes[cur])\n      return acc\n    }, [])\n  }\n\n  const getEdges = () => {\n    return _get('_edges', {})\n  }\n\n  const saveUploadedData = ({ edges, nodes }) => {\n    _set('_edges', edges)\n    _set('_nodes', nodes)\n  }\n\n  return {\n    getEdges,\n    getNodesObject,\n    saveUploadedData,\n    getNodes\n  }\n}\n\nexport const NodeManager = _NodeManager()\n","import get from 'lodash.get'\nimport differenceby from 'lodash.differenceby'\nimport uuid from 'uuid/v4'\n\nconst _Graph = () => {\n  const _get = (key, defaultValue) => JSON.parse(localStorage.getItem(key)) || defaultValue\n  const _set = (key, value) => localStorage.setItem(key, JSON.stringify(value))\n\n  const getEdges = async () => {\n    return _get('_edges', {})\n  }\n\n  const getNodes = async () => {\n    return _get('_nodes', {})\n  }\n\n  const setEdges = async (edges) => {\n    return _set('_edges', edges)\n  }\n\n  const setNodes = async (nodes) => {\n    return _set('_nodes', nodes)\n  }\n\n  const addNode = async (node) => {\n    if (!node.id) throw new Error('Nodes must have IDs to be added')\n    const _nodes = await getNodes()\n\n    _nodes[node.id] = node\n\n    await makeEdges(node)\n    await setNodes(_nodes)\n  }\n\n  const addEdge = async (node1, node2, data) => {\n    if (!node1.id || !node2.id) throw new Error('Nodes must have IDs to add edges')\n\n    const _edges = await getEdges()\n\n    if (!Array.isArray(_edges[node1.id])) _edges[node1.id] = []\n    if (!Array.isArray(_edges[node2.id])) _edges[node2.id] = []\n\n    await addDirectedEdge(node1, node2, data)\n    await addDirectedEdge(node2, node1, data)\n  }\n\n  const addDirectedEdge = async (node1, node2, data) => {\n    if (!node1.id || !node2.id) throw new Error('Nodes must have IDs to add directed edges')\n\n    const _edges = await getEdges()\n\n    if (!Array.isArray(_edges[node1.id])) _edges[node1.id] = []\n\n    const node2TargetID = _edges[node1.id].findIndex(({ node }) => node === node2.id)\n\n    if (node2TargetID >= 0) {\n      // Replace edge because it exists already\n      _edges[node1.id][node2TargetID] = { node: node2.id, data }\n    } else {\n      // Add edge, it does not exist\n      _edges[node1.id].push({ node: node2.id, data })\n    }\n\n    await setEdges({ ..._edges })\n  }\n\n  const removeDirectedEdge = async (node1, node2) => {\n    if (!node1.id || !node2.id) throw new Error('Nodes must have IDs to remove directed eges')\n\n    const _edges = await getEdges()\n\n    _edges[node1.id] = _edges[node1.id].filter(({ node }) => node !== node2.id)\n\n    await setEdges(_edges)\n  }\n\n  const removeEdge = async (node1, node2) => {\n    if (!node1.id || !node2.id) throw new Error('Nodes must have IDs to remove edges')\n\n    const _edges = await getEdges()\n\n    _edges[node1.id] = _edges[node1.id].filter(({ node }) => node !== node2.id)\n    _edges[node2.id] = _edges[node2.id].filter(({ node }) => node !== node1.id)\n\n    await setEdges(_edges)\n  }\n\n  const makeNode = async ({ id, data, connections }) => {\n    let node = null\n    if (id) {\n      const nodes = await getNodes()\n      node = {\n        id,\n        edges: [],\n        previousEdges: nodes[id].edges.map(item => ({ ...item })),\n        data: {\n          ...nodes[id].data,\n          ...data\n        }\n      }\n    } else {\n      node = {\n        id: uuid(),\n        edges: [],\n        data: {\n          ...(data || {})\n        }\n      }\n    }\n\n    const connectionKeys = Object.keys(connections || {})\n    const previousEdges = get(node, 'previousEdges', [])\n\n    if (connectionKeys.length <= 0 && previousEdges.length > 0) {\n      const edges = await getEdges()\n      delete edges[node.id]\n      const removeEdges = []\n      Object.keys(edges).forEach(key => {\n        edges[key].forEach((edge, index) => {\n          if (edge.node === node.id) {\n            removeEdges.push({ key, index })\n          }\n        })\n      })\n      removeEdges.forEach(remove => {\n        edges[remove.key].splice(remove.index, 1)\n      })\n      await setEdges({ ...edges })\n      return node\n    }\n\n    connectionKeys.forEach(key => {\n      const info = get(connections, `${[key]}.connectedTo`, null)\n      if (!info) throw new Error('You cannot make a connection without a target')\n      const type = get(connections, `${[key]}.connectionType`, null)\n      if (!type) throw new Error('You cannot make a connection without a type')\n\n      const read = get(connections, `${[key]}.read`, null)\n      const write = get(connections, `${[key]}.write`, null)\n\n      if (!read && !write) throw new Error('You must specify a read or a write option')\n\n      const data = get(connections, `[${key}].data`, {})\n\n      const existingEdgeIndex = node.edges.findIndex(edge => edge.id === key)\n\n      if (existingEdgeIndex >= 0) {\n        node.edges[existingEdgeIndex] = {\n          id: info.key,\n          data: {\n            ...data,\n            read,\n            write,\n            type: {\n              id: type.key,\n              label: type.text\n            }\n          }\n        }\n      } else {\n        node.edges.push({\n          id: info.key,\n          data: {\n            ...data,\n            read,\n            write,\n            type: {\n              id: type.key,\n              label: type.text\n            }\n          }\n        })\n      }\n    })\n    return node\n  }\n\n  const makeEdges = async (node) => {\n    const edges = get(node, 'edges', [])\n    const previousEdges = get(node, 'previousEdges', [])\n\n    if (edges.length <= 0) return\n\n    for (let i = 0; i < edges.length; i++) {\n      const edge = edges[i]\n\n      const read = get(edge, 'data.read')\n      const write = get(edge, 'data.write')\n\n      const node1 = {\n        id: get(node, 'id')\n      }\n      const node2 = {\n        id: get(edge, 'id')\n      }\n\n      const prevEdge = previousEdges.find(({ id }) => id === edge.id)\n\n      const prev = {\n        read: get(prevEdge, `data.read`, read),\n        write: get(prevEdge, `data.write`, write)\n      }\n\n      if (prev.read && !read) {\n        await removeDirectedEdge(node2, node1)\n      }\n\n      if (prev.write && !write) {\n        await removeDirectedEdge(node1, node2)\n      }\n\n      if (read && write) {\n        await addEdge(node1, node2, get(edge, 'data'))\n      } else if (read) {\n        await addDirectedEdge(node2, node1, get(edge, 'data'))\n      } else if (write) {\n        await addDirectedEdge(node1, node2, get(edge, 'data'))\n      }\n    }\n\n    const cleanup = differenceby(previousEdges, node.edges, 'id')\n\n    if (cleanup.length >= 0) {\n      for (let i = 0; i < cleanup.length; i++) {\n        const edge = cleanup[i]\n\n        const read = get(edge, 'data.read')\n        const write = get(edge, 'data.write')\n\n        const node1 = {\n          id: get(node, 'id')\n        }\n        const node2 = {\n          id: get(edge, 'id')\n        }\n\n        if (read && write) {\n          await removeEdge(node1, node2)\n        } else if (read) {\n          await removeDirectedEdge(node2, node1)\n        } else if (write) {\n          await removeDirectedEdge(node1, node2)\n        }\n      }\n    }\n  }\n\n  return {\n    addNode,\n    removeEdge,\n    removeDirectedEdge,\n    makeNode\n  }\n}\n\nexport const Graph = _Graph()\n","import { Network as VisNetwork, DataSet } from 'vis-network'\n\nconst _Network = () => {\n  let _nodes = []\n  let _edges = []\n  let _options = {}\n  let _container = null\n  let _network = null\n\n  const inContainer = element => {\n    _container = element\n    return builder\n  }\n\n  const withNodes = nodes => {\n    _nodes = nodes\n    return builder\n  }\n\n  const withEdges = edges => {\n    _edges = edges\n    return builder\n  }\n\n  const withOptions = options => {\n    _options = options\n    return builder\n  }\n\n  const makeData = () => {\n    return {\n      nodes: new DataSet(_nodes),\n      edges: new DataSet(_edges)\n    }\n  }\n\n  const build = () => {\n    if (!_network) {\n      _network = new VisNetwork(_container, makeData(), _options)\n    }\n    return {\n      network: _network,\n      setData: ({ nodes, edges }) => {\n        _nodes = nodes\n        _edges = edges\n        _network.setData(makeData())\n      },\n      getNodes: () => _nodes,\n      getEdges: () => _edges\n    }\n  }\n\n  const builder = {\n    withEdges,\n    withNodes,\n    withOptions,\n    inContainer,\n    build\n  }\n\n  return builder\n}\n\nexport const Network = _Network()\n","import { useEffect } from 'react'\nimport { Subject } from '../util/Subject'\n\nexport const useEvent = (event, handler) => {\n  useEffect(() => {\n    if (typeof handler !== 'function') return\n    Subject.subscribe(event, handler)\n    return () => Subject.unsubscribe(event, handler)\n  }, [event, handler])\n\n  return value => Subject.next(event, value)\n}\n","import React, { useReducer, useEffect, useCallback, useState, useRef } from 'react'\nimport { Network, NodeManager } from '../../util'\nimport { useEvent } from '../../hooks'\nimport get from 'lodash.get'\n\nconst systemsReducer = (state, action) => {\n  switch (action.type) {\n    case 'update':\n      const nodes = NodeManager.getNodes()\n      const edges = NodeManager.getEdges()\n      return buildGraphData(nodes, edges)\n    default:\n      return state\n  }\n}\n\nconst getLinkColor = (type) => {\n  switch (type) {\n    case 'custom':\n      return '#005481'\n    case 'builtin':\n      return '#9e6614'\n    default:\n      return '#A0A0A0'\n  }\n}\n\nconst getShape = (type) => {\n  switch (type) {\n    case 'cloud':\n      return { size: 40, widthConstraint: { minimum: 40, maximum: 100 } }\n    case 'external':\n      return { shape: 'circle', size: 40, widthConstraint: { minimum: 40, maximum: 100 } }\n    case 'oncampus':\n    default:\n      return { shape: 'box', size: 40, widthConstraint: { minimum: 40, maximum: 100 } }\n  }\n}\n\nconst buildGraphData = (nodes, edges) => {\n  const graphData = {\n    nodes: [],\n    edges: []\n  }\n  if (!Array.isArray(nodes)) {\n    return {\n      nodes: [],\n      edges: []\n    }\n  }\n\n  const nodeKeys = Object.keys(nodes || {})\n  nodeKeys.forEach(key => {\n    const node = nodes[key]\n\n    graphData.nodes.push({\n      id: node.id,\n      type: node.data.type,\n      ...getShape(node.data.type),\n      label: node.data.name,\n      edges: node.edges,\n      shadow: {\n        enabled: true,\n        size: 4,\n        x: 1,\n        y: 1\n      },\n      data: {\n        ...node.data\n      },\n      color: '#FFFFFF'\n    })\n  })\n\n  const edgeKeys = Object.keys(edges || {})\n  edgeKeys.forEach(nodeId => {\n    const edgeList = edges[nodeId]\n\n    edgeList.forEach(edge => {\n      graphData.edges.push({\n        from: nodeId,\n        to: edge.node,\n        color: {\n          color: getLinkColor(get(edge, 'data.type.id')),\n          hover: '#501214'\n        },\n        dashes: get(edge, 'data.type.id') === 'custom',\n        type: get(edge, 'data.type', {}),\n        arrows: 'to'\n      })\n    })\n  })\n\n  return graphData\n}\n\nexport const SystemsGraph = () => {\n  const [systems, systemsDispatch] = useReducer(systemsReducer, buildGraphData(NodeManager.getNodes(), NodeManager.getEdges()))\n  const [activeNode, setActiveNode] = useState()\n\n  const graphContainer = useRef()\n  const graph = useRef()\n\n  const updateGraph = () => {\n    systemsDispatch({ type: 'update' })\n  }\n  const resetActiveNode = () => setActiveNode(null)\n  const displayNodeDetails = useEvent('display-node-details')\n\n  const handleRightClick = useCallback(event => {\n    const node = graph.current.network.getNodeAt(event.pointer.DOM)\n    if (graph.current.network.isCluster(node)) {\n      graph.current.network.openCluster(node)\n    } else {\n      const matchingNode = systems.nodes.find(({ id }) => id === node)\n      if (!matchingNode) return\n      graph.current.network.clusterByConnection(node, { clusterNodeProperties: { label: matchingNode.data.name } })\n    }\n  }, [systems])\n\n  const handleNodeSelect = useCallback(params => {\n    const node = get(params, `nodes[0]`, null)\n    if (node) {\n      if (!graph.current.network.isCluster(node)) {\n        const matchingNode = systems.nodes.find(({ id }) => id === node)\n        if (matchingNode) {\n          setActiveNode(matchingNode)\n        }\n      }\n    }\n  }, [systems.nodes])\n\n  useEffect(() => {\n    if (activeNode) displayNodeDetails(activeNode)\n  }, [activeNode, displayNodeDetails])\n\n  useEvent('save-node-entry', updateGraph)\n  useEvent('deselect-active-node', resetActiveNode)\n\n  useEffect(() => {\n    const options = {\n      autoResize: false,\n      interaction: {\n        hover: true,\n        hoverConnectedEdges: true\n      }\n    }\n\n    if (!graph.current) {\n      const systemGraph = Network\n        .inContainer(graphContainer.current)\n        .withEdges(systems.edges)\n        .withNodes(systems.nodes)\n        .withOptions(options)\n        .build()\n\n      graph.current = systemGraph\n\n      graph.current.network.on('oncontext', handleRightClick)\n      graph.current.network.on('selectNode', handleNodeSelect)\n\n      document.addEventListener('contextmenu', e => e.preventDefault(), false)\n    } else {\n      graph.current.network.off('oncontext', handleRightClick)\n      graph.current.network.off('selectNode', handleNodeSelect)\n      graph.current.network.on('oncontext', handleRightClick)\n      graph.current.network.on('selectNode', handleNodeSelect)\n\n      graph.current.setData(systems)\n    }\n  }, [systems, handleNodeSelect, handleRightClick])\n\n  return <div style={{ overflow: 'hidden', flex: 1 }} ref={graphContainer} id='graph' />\n}\n","import dayjs from 'dayjs'\nimport get from 'lodash.get'\nimport { NodeManager } from './NodeManager'\nimport { Subject } from './Subject'\n\nexport const downloadFile = (filename, data) => {\n  const element = document.createElement('a')\n  element.setAttribute('href', `data:text/plain;charset=utf-8,${encodeURIComponent(data)}`)\n  element.setAttribute('download', `${filename} - ${dayjs().format('YYYY-MM-DD/THHmmss')}.json`)\n\n  element.style.display = 'none'\n  document.body.appendChild(element)\n  element.click()\n  document.body.removeChild(element)\n}\n\nconst handleFile = (event) => {\n  const reader = new FileReader()\n  reader.readAsBinaryString(event.target.files[0])\n\n  reader.onloadend = async () => {\n    const data = JSON.parse(reader.result)\n    const edges = get(data, 'edges', {})\n    const nodes = get(data, 'nodes', {})\n\n    NodeManager.saveUploadedData({ edges, nodes })\n    Subject.next('save-node-entry')\n  }\n}\n\nexport const uploadFile = () => {\n  const element = document.createElement('input')\n  element.setAttribute('type', 'file')\n  element.setAttribute('accept', '.json')\n\n  element.style.display = 'none'\n  element.addEventListener('change', handleFile)\n  element.click()\n}\n","import React from 'react'\nimport { useEvent } from '../../hooks'\nimport { CommandBar as OfficeCommandBar } from 'office-ui-fabric-react/lib/CommandBar'\nimport { downloadFile, uploadFile } from '../../util/FileManager'\nimport { NodeManager } from '../../util/NodeManager'\n\nexport const CommandBar = props => {\n  const toggleLeftPanel = useEvent('toggle-left-panel')\n\n  const items = [\n    {\n      key: 'addNode',\n      name: 'Add System',\n      iconProps: {\n        iconName: 'Add'\n      },\n      onClick: toggleLeftPanel\n    },\n    {\n      key: 'upload',\n      name: 'Upload',\n      iconProps: {\n        iconName: 'Upload'\n      },\n      onClick: () => {\n        uploadFile()\n      }\n    },\n    {\n      key: 'download',\n      name: 'Download',\n      iconProps: {\n        iconName: 'Download'\n      },\n      onClick: () => {\n        const edges = NodeManager.getEdges()\n        const nodes = NodeManager.getNodesObject()\n\n        const filename = 'TR_Systems'\n        downloadFile(filename, JSON.stringify({ edges, nodes }, null, 2))\n      }\n    }\n  ]\n\n  return (\n    <div style={{ position: 'fixed', top: 0, left: 0, right: 0 }}>\n      <OfficeCommandBar\n        items={items}\n      />\n    </div>\n  )\n}\n","import React from 'react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox'\n\nconst canChange = (nextPath, nextValue) => (currentRead, currentWrite) => {\n  if (nextPath === 'read') {\n    return nextValue || currentWrite || false\n  }\n\n  if (nextPath === 'write') {\n    return nextValue || currentRead || false\n  }\n  return false\n}\n\nexport const ConnectionReadWrite = props => {\n  const { read, write, onChange } = props\n\n  return (\n    <Stack style={{ marginRight: 8, marginTop: 8 }} verticalAlign='space-between' tokens={{ childrenGap: 4 }}>\n      <Checkbox checked={read} onChange={(event, value) => {\n        if (canChange('read', value)(read, write)) {\n          onChange('read', value)\n        }\n      }} label='Read' />\n      <Checkbox checked={write} onChange={(event, value) => {\n        if (canChange('write', value)(read, write)) {\n          onChange('write', value)\n        }\n      }} label='Write' />\n    </Stack>\n  )\n}\n","import React, { useEffect } from 'react'\nimport styled from 'styled-components'\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown'\nimport { ConnectionReadWrite } from './ConnectionReadWrite'\nimport get from 'lodash.get'\nimport { IconButton } from 'office-ui-fabric-react'\n\nconst ConnectionContainer = styled.div`\n  display: flex;\n  align-items: flex-start;\n  flex-direction: column;\n  justify-content: flex-start;\n  padding: 8px;\n  margin-top: 12px;\n  border: 1px solid rgb(138, 136, 134);\n  box-sizing: border-box;\n  border-radius: 1px;\n\n  & > .ms-Dropdown-container {\n    flex: 1;\n    width: 100%;\n    margin-right: 4px;\n  }\n\n  & > .ms-Button--icon {\n    align-self: flex-end;\n  }\n`\n\nexport const Connection = props => {\n  const { handleRemove, id, edit, addNodeForm, nodeFormErrors, setNodeFormErrors, existingSystems, updateNodeForm } = props\n  const selectedTarget = get(addNodeForm, `connections[${id}].connectedTo.key`, null)\n  const selectedType = get(addNodeForm, `connections[${id}].connectionType.key`, null)\n\n  const selectedRead = get(addNodeForm, `connections[${id}].read`, true)\n  const selectedWrite = get(addNodeForm, `connections[${id}].write`, false)\n\n  const targetError = get(nodeFormErrors, `[${id}].target`)\n  const typeError = get(nodeFormErrors, `[${id}].type`)\n\n  useEffect(() => {\n    if (!edit) {\n      updateNodeForm({\n        path: `connections[${id}].read`,\n        value: true\n      })\n    }\n  }, [updateNodeForm, id, edit])\n\n  return (\n    <ConnectionContainer>\n      <IconButton\n        iconProps={{ iconName: 'ChromeClose' }}\n        onClick={() => {\n          const connection = get(addNodeForm, `connections[${id}]`, null)\n          if (connection) {\n            updateNodeForm({\n              path: `connections[${id}]`,\n              type: 'remove'\n            })\n          }\n          handleRemove()\n        }}\n      />\n      <Dropdown\n        label='Connected To'\n        placeholder={`What does this system connect to?`}\n        options={existingSystems}\n        errorMessage={targetError}\n        selectedKey={selectedTarget}\n        onChange={(event, value) => {\n          updateNodeForm({\n            path: `connections[${id}].connectedTo`,\n            value: { key: value.key, text: value.text }\n          })\n          if (`${id}` in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors[id]\n            setNodeFormErrors(errors)\n          }\n        }}\n      />\n      <Dropdown\n        label='Interface'\n        options={[\n          { key: 'builtin', text: 'Built In' },\n          { key: 'custom', text: 'Custom' }\n        ]}\n        placeholder='How does this system connect?'\n        selectedKey={selectedType}\n        errorMessage={typeError}\n        onChange={(event, value) => {\n          updateNodeForm({\n            path: `connections[${id}].connectionType`,\n            value: { key: value.key, text: value.text, color: value.color }\n          })\n          if (`${id}` in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors[id]\n            setNodeFormErrors(errors)\n          }\n        }}\n      />\n      <ConnectionReadWrite\n        read={selectedRead}\n        write={selectedWrite}\n        onChange={(path, value) => {\n          updateNodeForm({\n            path: `connections[${id}].${path}`,\n            value\n          })\n        }}\n      />\n    </ConnectionContainer>\n  )\n}\n","import React from 'react'\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown'\n\nconst areEqual = (prevProps, nextProps) => {\n  const keysUnchanged = prevProps.selectedKey === nextProps.selectedKey\n  const errorUnchanged = prevProps.errorMessage === nextProps.errorMessage\n  return keysUnchanged && errorUnchanged\n}\n\nexport const SystemType = React.memo(props => {\n  const { selectedKey, onChange, required, errorMessage } = props\n\n  return (\n    <Dropdown\n      required={required}\n      label='System Type'\n      options={[\n        { key: 'oncampus', text: 'On Campus' },\n        { key: 'cloud', text: 'Cloud' },\n        { key: 'external', text: 'External' }\n      ]}\n      errorMessage={errorMessage}\n      placeholder='Where does this system live?'\n      selectedKey={selectedKey}\n      onChange={onChange}\n    />\n  )\n}, areEqual)\n","import React from 'react'\nimport { TextField } from 'office-ui-fabric-react/lib/TextField'\nimport { ActionButton } from 'office-ui-fabric-react'\nimport { SystemType } from './SystemType'\n\nconst renderConnections = ({ connections, existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors }) => {\n  return connections.map(conn => React.cloneElement(conn, { existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors }))\n}\n\nconst checkURL = url => {\n  if (!url) return\n  try {\n    const checkedURL = new URL(url)\n    if (checkedURL) return null\n  } catch (err) {\n    return err.message\n  }\n}\n\nexport const SystemFormView = props => {\n  const {\n    nodeFormErrors,\n    existingSystems,\n    setNodeFormErrors,\n    addNodeForm,\n    updateNodeForm,\n    connections,\n    addConnection,\n    edit\n  } = props\n  return (\n    <>\n      <TextField\n        label='Name'\n        placeholder='Choose a name'\n        errorMessage={nodeFormErrors.name}\n        required\n        onGetErrorMessage={(value => {\n          const newSystem = String(value).toLowerCase()\n          const nameExists = existingSystems.some(({ text }) => String(text).toLowerCase() === newSystem)\n          if (nameExists && !edit) {\n            setNodeFormErrors({\n              ...nodeFormErrors,\n              name: `The ${value} system already exists`\n            })\n          } else {\n            if (nodeFormErrors.name) {\n              const errors = {\n                ...nodeFormErrors\n              }\n              delete errors.name\n              setNodeFormErrors(errors)\n            }\n          }\n        })}\n        onChange={(event, value) => updateNodeForm({ path: 'name', value })}\n        value={addNodeForm.name || ''}\n      />\n      <SystemType\n        required\n        errorMessage={nodeFormErrors.type}\n        selectedKey={addNodeForm.type || null}\n        onChange={(event, value) => {\n          updateNodeForm({ path: 'type', value: value.key })\n          if ('type' in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors.type\n            setNodeFormErrors(errors)\n          }\n        }}\n      />\n      <TextField\n        label='Department'\n        placeholder='Was this built for another department?'\n        onChange={(event, value) => updateNodeForm({ path: 'department', value })}\n        value={addNodeForm.department || ''}\n      />\n      <TextField\n        label='URL'\n        placeholder='Is there a url to access this system?'\n        onChange={(event, value) => updateNodeForm({ path: 'url', value })}\n        onGetErrorMessage={value => checkURL(value)}\n        value={addNodeForm.url || ''}\n      />\n      <TextField\n        label='Description'\n        placeholder='Enter some information others may want to know about this system'\n        multiline\n        rows={4}\n        onChange={(event, value) => updateNodeForm({ path: 'description', value })}\n        value={addNodeForm.description || ''}\n      />\n      {renderConnections({ connections, existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors })}\n      <ActionButton\n        onClick={addConnection}\n        iconProps={{ iconName: 'Add' }}\n      >\n        Add Connection\n      </ActionButton>\n    </>\n  )\n}\n","import React, { useState, useReducer } from 'react'\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel'\nimport { NodeManager, Graph } from '../../util'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react'\nimport { useEvent } from '../../hooks'\nimport get from 'lodash.get'\nimport uuid from 'uuid/v4'\nimport set from 'lodash.set'\nimport unset from 'lodash.unset'\nimport { Connection } from './Connection'\nimport { Network } from '../../util/Network'\nimport { SystemFormView } from './SystemFormView'\n\nconst makeConnections = (system, nodes) => {\n  const connections = {}\n  system.edges.forEach(edge => {\n    connections[edge.id] = {\n      read: edge.data.read,\n      write: edge.data.write,\n      connectionType: {\n        key: edge.data.type.id,\n        text: edge.data.type.label\n      },\n      connectedTo: {\n        key: edge.id,\n        text: get(nodes.filter(node => node.id === edge.id), '[0].data.name', '')\n      }\n    }\n  })\n  return connections\n}\n\nconst makeFormState = system => {\n  const { network, getNodes } = Network.build()\n  const nodes = network.getConnectedNodes(system.id)\n\n  const connectedNodes = getNodes().filter(({ id }) => nodes.includes(id))\n\n  const formState = {\n    name: get(system, 'data.name'),\n    id: get(system, 'id'),\n    type: get(system, 'data.type'),\n    department: get(system, 'data.department'),\n    url: get(system, 'data.url'),\n    description: get(system, 'data.description'),\n    connections: makeConnections(system, connectedNodes)\n  }\n  return formState\n}\n\nconst addNodeReducer = (state, action) => {\n  if (action.path === '') return {}\n  const addNodeState = { ...state }\n  switch (action.type) {\n    case 'remove':\n      unset(addNodeState, action.path)\n      return addNodeState\n    case 'edit':\n      return { ...action.formState }\n    default:\n      set(addNodeState, action.path, action.value)\n      return addNodeState\n  }\n}\n\nconst connectionReducer = (connections, action) => {\n  switch (action.type) {\n    case 'add':\n      const id = uuid()\n      return [\n        ...connections,\n        <Connection\n          key={id}\n          id={id}\n          handleRemove={() => action.dispatch({ type: 'remove', id })}\n        />\n      ]\n    case 'remove':\n      return connections.filter(({ key }) => key !== action.id)\n    case 'reset':\n      return []\n    case 'edit':\n      const connKeys = Object.keys(action.connections)\n      return connKeys.map(key => {\n        const id = key\n        const dispatch = get(action, 'dispatch', null)\n\n        if (!dispatch || !id) return null\n\n        return (\n          <Connection\n            edit\n            key={id}\n            id={id}\n            handleRemove={() => dispatch({ type: 'remove', id })}\n          />\n        )\n      }).filter(item => item)\n    default:\n      return connections\n  }\n}\n\nconst getSystems = () => {\n  const nodes = NodeManager.getNodes()\n  return nodes.map(node => ({ key: node.id, text: node.data.name }))\n}\n\nconst validate = (addNodeForm, nodeFormErrors) => {\n  let errors = {}\n  if (nodeFormErrors) {\n    errors = {\n      ...nodeFormErrors\n    }\n  }\n\n  if (!addNodeForm.type) {\n    errors.type = 'A system type must be selected'\n  }\n\n  if (!addNodeForm.name) {\n    errors.name = 'A system name is required'\n  }\n\n  if (addNodeForm.connections) {\n    const keys = Object.keys(addNodeForm.connections || {})\n    keys.forEach(key => {\n      const target = get(addNodeForm, `connections[${key}].connectedTo.key`, null)\n      const type = get(addNodeForm, `connections[${key}].connectionType.key`, null)\n\n      if (!type) set(errors, `[${key}].type`, 'The connection must have a type selected')\n      if (!target) set(errors, `[${key}].target`, 'You must select another system to connect to')\n    })\n  }\n\n  return errors\n}\n\nexport const SystemForm = (props) => {\n  const [edit, setEdit] = useState(false)\n  const [isOpen, setIsOpen] = useState(false)\n  const [addNodeForm, updateNodeForm] = useReducer(addNodeReducer, {})\n  const [existingSystems, setExistingSystems] = useState(getSystems())\n  const [nodeFormErrors, setNodeFormErrors] = useState({})\n  const [connections, connDispatch] = useReducer(connectionReducer, [])\n\n  const toggle = () => setIsOpen(!isOpen)\n  const resetForm = () => updateNodeForm({ path: '', value: {} })\n  const resetConnections = () => connDispatch({ type: 'reset' })\n\n  const handleEditSystem = (system) => {\n    const formState = makeFormState(system)\n    connDispatch({\n      type: 'edit',\n      connections: formState.connections || {},\n      dispatch: connDispatch\n    })\n    updateNodeForm({ type: 'edit', formState })\n    setEdit(true)\n    setIsOpen(true)\n  }\n\n  useEvent('edit-system-panel', handleEditSystem)\n\n  const addConnection = () => {\n    connDispatch({\n      type: 'add',\n      dispatch: connDispatch,\n      existingSystems,\n      addNodeForm,\n      updateNodeForm\n    })\n  }\n\n  const submitSystem = async () => {\n    const errors = validate(addNodeForm, nodeFormErrors)\n    if (Object.keys(errors).length > 0) {\n      setNodeFormErrors({\n        ...nodeFormErrors,\n        ...errors\n      })\n      return\n    }\n\n    const connections = get(addNodeForm, 'connections', {})\n    const data = {\n      description: get(addNodeForm, 'description', ''),\n      name: get(addNodeForm, 'name', ''),\n      type: get(addNodeForm, 'type', ''),\n      url: get(addNodeForm, 'url', ''),\n      department: get(addNodeForm, 'department', '')\n    }\n\n    if (edit) {\n      const node = await Graph.makeNode({ id: addNodeForm.id, connections, data })\n      await Graph.addNode(node)\n    } else {\n      const node = await Graph.makeNode({ connections, data })\n      await Graph.addNode(node)\n    }\n\n    broadcastNodeSave()\n    resetConnections()\n    resetForm()\n  }\n\n  useEvent('toggle-left-panel', toggle)\n  const dismiss = () => {\n    resetForm()\n    resetConnections()\n    setIsOpen(false)\n    setEdit(false)\n  }\n\n  const updateExistingSystems = () => {\n    const systems = getSystems()\n    setExistingSystems(systems)\n  }\n\n  const broadcastNodeSave = useEvent('save-node-entry', updateExistingSystems)\n\n  return (\n    <Panel\n      headerText={`${edit ? 'Edit' : 'Add'} System`}\n      isOpen={isOpen}\n      onDismiss={dismiss}\n      isFooterAtBottom\n      onRenderFooterContent={() => (\n        <Stack horizontal horizontalAlign='space-between' tokens={{ childrenGap: 12 }}>\n          <DefaultButton text='Cancel' onClick={dismiss} />\n          <PrimaryButton text='Save System' onClick={submitSystem} />\n        </Stack>\n      )}\n      type={PanelType.medium}\n    >\n      <SystemFormView\n        edit={edit}\n        existingSystems={existingSystems}\n        nodeFormErrors={nodeFormErrors}\n        setNodeFormErrors={setNodeFormErrors}\n        addNodeForm={addNodeForm}\n        updateNodeForm={updateNodeForm}\n        connections={connections}\n        addConnection={addConnection}\n      />\n    </Panel>\n  )\n}\n","import React from 'react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\n\nconst NodeDetailView = props => {\n  const { description, department, url, connections } = props\n  return (\n    <Stack tokens={{ childrenGap: 8 }}>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>Description</Text>\n        <Text>{description}</Text>\n      </Stack>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>Department</Text>\n        <Text>{department}</Text>\n      </Stack>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>URL</Text>\n        <a href={url}>{url}</a>\n      </Stack>\n      <Stack>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>Connections</Text>\n        {connections}\n      </Stack>\n    </Stack>\n  )\n}\n\nexport default NodeDetailView\n","import React, { useState } from 'react'\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel'\nimport { IconButton } from 'office-ui-fabric-react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\nimport styled from 'styled-components'\nimport get from 'lodash.get'\nimport { useEvent } from '../../hooks'\nimport { NodeManager } from '../../util'\nimport NodeDetailView from './NodeDetailView'\n\nconst CustomPanel = styled(Panel)`\n  & > .ms-Panel-main {\n    transition: width 300ms ease-in-out;\n  }\n`\nconst parseConnections = (node) => {\n  if (!node) return []\n  const edges = NodeManager.getEdges()\n  const nodes = NodeManager.getNodesObject()\n\n  const edgeKeys = Object.keys(edges || {})\n  return edgeKeys.reduce((acc, cur) => {\n    const nodeEdges = edges[cur]\n    nodeEdges\n      .filter(edge => edge.node === node.id)\n      .forEach(edge => {\n        const to = get(nodes, `[${cur}].data.name`)\n\n        const type = get(edge, 'data.type.label')\n        const read = get(edge, 'data.read')\n        const write = get(edge, 'data.write')\n\n        acc.push(<Connection key={edge.node} to={to} read={read} write={write} type={type} />)\n      })\n    return acc\n  }, [])\n}\n\nconst Connection = ({ to, type, read, write }) => {\n  let readWriteStatus = ''\n  if (read && write) {\n    readWriteStatus = '(Read and Write)'\n  } else if (read) {\n    readWriteStatus = '(Read)'\n  } else if (write) {\n    readWriteStatus = '(Write)'\n  }\n  return (\n    <Text>{to} - {type} {readWriteStatus}</Text>\n  )\n}\n\nexport const NodeDetail = props => {\n  const [isOpen, setIsOpen] = useState(false)\n  const [node, setNode] = useState(null)\n  const displayNode = (node) => {\n    setNode(node)\n    setIsOpen(true)\n  }\n  const closePanel = () => setIsOpen(false)\n\n  useEvent('display-node-details', displayNode)\n  const editSystem = useEvent('edit-system-panel')\n  const deselectActiveNode = useEvent('deselect-active-node')\n  const name = get(node, 'data.name', 'Very Unnamed System')\n  const description = get(node, 'data.description', 'No description has been entered.')\n  const department = get(node, 'data.department', 'No department has been entered.')\n  const url = get(node, 'data.url', `${name} has no url`)\n\n  const connections = parseConnections(node)\n  const handleEdit = () => {\n    editSystem(node)\n    setIsOpen(false)\n    deselectActiveNode()\n  }\n\n  return (\n    <CustomPanel\n      isOpen={isOpen}\n      onDismiss={() => {\n        deselectActiveNode()\n        closePanel()\n      }}\n      onRenderHeader={(props) => {\n        return (\n          <Stack horizontal tokens={{ childrenGap: 12 }}>\n            <Text variant='xLarge' style={{ marginLeft: 16, marginBottom: 12 }}>{props.headerText}</Text>\n            <IconButton\n              iconProps={{\n                iconName: 'Edit'\n              }}\n              onClick={handleEdit}\n            />\n          </Stack>\n        )\n      }}\n      isLightDismiss\n      type={PanelType.customNear}\n      customWidth={400}\n      headerText={name}\n    >\n      <NodeDetailView\n        connections={connections}\n        department={department}\n        description={description}\n        url={url}\n      />\n    </CustomPanel>\n  )\n}\n","import React from 'react'\nimport styled, { keyframes, css } from 'styled-components'\n\nconst cubeMove = keyframes`\n    25% { \n      transform: translateX(42px) rotate(-90deg) scale(0.5);\n      -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5);\n    } 50% { \n      transform: translateX(42px) translateY(42px) rotate(-179deg);\n      -webkit-transform: translateX(42px) translateY(42px) rotate(-179deg);\n    } 50.1% { \n      transform: translateX(42px) translateY(42px) rotate(-180deg);\n      -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg);\n    } 75% { \n      transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n      -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n    } 100% { \n      transform: rotate(-360deg);\n      -webkit-transform: rotate(-360deg);\n    }\n`\n\nconst Spinner = styled.div`\n  margin: 100px auto;\n  width: 40px;\n  height: 40px;\n  align-self: center;\n  justify-self: center;\n  position: relative;\n`\n\nconst cubeCSS = css`\n  background-color: #501214;\n  width: 15px;\n  height: 15px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  \n  -webkit-animation: ${cubeMove} 1.8s infinite ease-in-out;\n  animation: ${cubeMove} 1.8s infinite ease-in-out;\n`\n\nconst CubeOne = styled.div`\n  ${cubeCSS}\n`\nconst CubeTwo = styled.div`\n  ${cubeCSS}\n  animation-delay: -0.9s;\n`\n\nexport const Loading = props => {\n  return (\n    <Spinner>\n      <CubeOne />\n      <CubeTwo />\n    </Spinner>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\nimport { SystemsGraph, NodeDetail, SystemForm, CommandBar } from './components'\n\nconst Page = styled.div`\n  background-color: #e8e3db;\n  flex: 1;\n  flex-direction: column;\n  display: flex;\n`\n\nfunction App () {\n  return (\n    <Page>\n      <SystemsGraph />\n      <CommandBar />\n      <SystemForm />\n      <NodeDetail />\n    </Page>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons'\nimport App from './App'\n\ninitializeIcons()\n\nrender(<App />, document.getElementById('root'))\n"],"sourceRoot":""}