(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,t,n){e.exports=n(123)},123:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(45),c=n(153),i=n(46),u=n(52),s=n(30),d=n(12),l=n(16),f=n(93),p={},m={subscribe:function(e,t){p[e]||(p[e]=[]),p[e].push(t)},unsubscribe:function(e,t){p[e]&&(p[e]=p[e].filter(function(e){return e!==t}))},next:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];p[e]&&p[e].forEach(function(e){"function"===typeof e&&e.apply(void 0,n)})}};Object.freeze(m);var h=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t};return{getEdges:function(){return e("_edges",{})},getNodesObject:function(){return e("_nodes",{})},getNodes:function(){var t=e("_nodes",{});return Object.keys(t).reduce(function(e,n){return e.push(t[n]),e},[])}}}(),y=n(9),b=n.n(y),v=n(21),g=n(62),x=n.n(g),k=n(6),w=n.n(k),E=n(47),O=n.n(E),j=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t},t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},n=function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_edges",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),r=function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_nodes",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),a=function(){var e=Object(v.a)(b.a.mark(function e(n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.abrupt("return",t("_edges",n));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(v.a)(b.a.mark(function e(n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t("_nodes",n));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to be added");case 2:return e.next=4,r();case 4:return(n=e.sent)[t.id]=t,e.next=8,f(t);case 8:return e.next=10,o(n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(v.a)(b.a.mark(function e(t,r,o){var c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),Array.isArray(c[r.id])||(c[r.id]=[]),c[t.id].push({node:r.id,data:o}),c[r.id].push({node:t.id,data:o}),e.next=11,a(Object(l.a)({},c));case 11:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),u=function(){var e=Object(v.a)(b.a.mark(function e(t,r,o){var c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add directed edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),c[t.id].push({node:r.id,data:o}),e.next=9,a(Object(l.a)({},c));case 9:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),s=function(){var e=Object(v.a)(b.a.mark(function e(t){var r,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to remove directed eges");case 2:return e.next=4,n();case 4:return r=e.sent,o=x()(r,t.id),e.next=8,a(o);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(v.a)(b.a.mark(function e(t,r){var o,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to remove edges");case 2:return e.next=4,n();case 4:return o=e.sent,c=x()(o,[t.id,r.id]),e.next=8,a(c);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(v.a)(b.a.mark(function e(t){var n,r,a,o,c,s,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=w()(t,"edges",[])).length<=0)){e.next=3;break}return e.abrupt("return");case 3:r=0;case 4:if(!(r<n.length)){e.next=26;break}if(a=n[r],o=w()(a,"data.read"),c=w()(a,"data.write"),s={id:w()(t,"id")},d={id:w()(a,"id")},!o||!c){e.next=15;break}return e.next=13,i(s,d,w()(a,"data"));case 13:e.next=23;break;case 15:if(!o){e.next=20;break}return e.next=18,u(d,s,w()(a,"data"));case 18:e.next=23;break;case 20:if(!c){e.next=23;break}return e.next=23,u(s,d,w()(a,"data"));case 23:r++,e.next=4;break;case 26:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return{addNode:c,removeEdge:d,removeDirectedEdge:s,makeNode:function(e){var t=e.data,n=e.connections,r={id:O()(),edges:[],data:Object(l.a)({},t||{})},a=Object.keys(n||{});return a.length<=0?r:(a.forEach(function(e){var t=w()(n,"".concat([e],".connectedTo"),null);if(!t)throw new Error("You cannot make a connection without a target");var a=w()(n,"".concat([e],".connectionType"),null);if(!a)throw new Error("You cannot make a connection without a type");var o=w()(n,"".concat([e],".read"),null),c=w()(n,"".concat([e],".write"),null);if(!o&&!c)throw new Error("You must specify a read or a write option");var i=w()(n,"[".concat(e,"].data"),{});r.edges.push({id:t.key,data:Object(l.a)({},i,{read:o,write:c,type:{id:a.key,label:a.text}})})}),r)}}}(),N=function(e,t){return Object(r.useEffect)(function(){if("function"===typeof t)return m.subscribe(e,t),function(){return m.unsubscribe(e,t)}},[e,t]),function(t){return m.next(e,t)}},C=function(e,t){switch(t.type){case"update":var n=h.getNodes(),r=h.getEdges();return A(n,r);default:return e}},S=function(e){switch(e){case"custom":return"#4b721d";case"builtin":return"#deb407";default:return"#A0A0A0"}},A=function(e,t){var n={nodes:[],links:[]};return Array.isArray(e)?(Object.keys(e||{}).forEach(function(t){var r=e[t];console.log(r),n.nodes.push({id:r.id,type:r.data.type,name:r.data.name,data:Object(l.a)({},r.data),color:"#303030"})}),Object.keys(t||{}).forEach(function(e){t[e].forEach(function(t){n.links.push({source:e,target:t.node,color:S(w()(t,"data.type.id")),type:w()(t,"data.type",{})})})}),n):{nodes:[],links:[]}},D=function(e){var t=Object(r.useReducer)(C,A(h.getNodes(),h.getEdges())),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(),u=Object(d.a)(i,2),l=u[0],p=u[1],m=Object(r.useRef)(),y=N("display-node-details");return Object(r.useEffect)(function(){m.current.d3Force("charge").strength(-150),m.current.zoom(4)},[o.links]),Object(r.useEffect)(function(){l&&y(l)},[l,y]),N("save-node-entry",function(){c({type:"update"})}),N("deselect-active-node",function(){return p(null)}),a.a.createElement(f.a,{ref:m,graphData:o,linkDirectionalArrowLength:5,linkDirectionalArrowRelPos:.5,linkCurvature:.25,linkColor:function(e){return e.color},nodeVal:4.5,onNodeClick:function(e){e.id!==w()(l,"id",null)?p(e):p(null)},nodeCanvasObject:function(e,t,n){var r=w()(l,"id",null)===e.id,a=e.name,o=16/n;t.font="".concat(r?"bold ":"").concat(o,"px Sans-Serif");var c=t.measureText(a).width,i=[c,o].map(function(e){return e+3*o}),u=[c,o].map(function(e){return e+o*(r?3.4:3.2)});return t.fillStyle=r?"#005481":e.color,t.fillRect.apply(t,[e.x-u[0]/2,e.y-u[1]/2].concat(Object(s.a)(u))),t.fillStyle="rgba(255, 255, 255, 1)",t.fillRect.apply(t,[e.x-i[0]/2,e.y-i[1]/2].concat(Object(s.a)(i))),t.textAlign="center",t.textBaseline="middle",t.fillStyle=r?"#005481":e.color,t.fillText(a,e.x,e.y),t}})},F=n(154),T=function(e){var t=[{key:"addNode",name:"Add System",iconProps:{iconName:"Add"},onClick:N("toggle-left-panel")}];return a.a.createElement(F.a,{items:t})},R=n(158),I=n(14),M=n(159),W=n(161),_=n(97),L=n(94),P=n(152),q=n(54),G=n.n(q),J=n(89),K=n.n(J),z=n(38),B=n(157),Y=n(163),H=function(e,t){return function(n,r){return"read"===e?t||r||!1:"write"===e&&(t||n)||!1}},U=function(e){var t=e.read,n=e.write,r=e.onChange;return a.a.createElement(W.a,{style:{marginRight:8,marginLeft:8,alignSelf:"center"},verticalAlign:"space-between",tokens:{childrenGap:4}},a.a.createElement(Y.a,{checked:t,onChange:function(e,a){H("read",a)(t,n)&&r("read",a)},label:"Read"}),a.a.createElement(Y.a,{checked:n,onChange:function(e,a){H("write",a)(t,n)&&r("write",a)},label:"Write"}))},V=n(168);function Q(){var e=Object(i.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  padding-top: 16px;\n\n  & > .ms-Dropdown-container {\n    flex: 1;\n    margin-right: 4px;\n  }\n\n  & > .ms-Button--icon {\n    align-self: flex-end;\n  }\n"]);return Q=function(){return e},e}var X=u.a.div(Q()),Z=function(e){var t=e.handleRemove,n=e.id,o=e.addNodeForm,c=e.nodeFormErrors,i=e.setNodeFormErrors,u=e.existingSystems,s=e.updateNodeForm,d=w()(o,"connections[".concat(n,"].connectedTo.key"),null),f=w()(o,"connections[".concat(n,"].connectionType.key"),null),p=w()(o,"connections[".concat(n,"].read"),!0),m=w()(o,"connections[".concat(n,"].write"),!1),h=w()(c,"[".concat(n,"].target")),y=w()(c,"[".concat(n,"].type"));return Object(r.useEffect)(function(){s({path:"connections[".concat(n,"].read"),value:!0})},[s,n]),a.a.createElement(X,null,a.a.createElement(B.a,{label:"Connected To",placeholder:"What does ".concat(o.name||"this system"," connect to?"),options:u,errorMessage:h,selectedKey:d,onChange:function(e,t){s({path:"connections[".concat(n,"].connectedTo"),value:{key:t.key,text:t.text}}),i(Object(l.a)({},c,Object(z.a)({},n,{type:null})))}}),a.a.createElement(B.a,{label:"Interface",options:[{key:"builtin",text:"Built In"},{key:"custom",text:"Custom"}],placeholder:"How does this system connect?",selectedKey:f,errorMessage:y,onChange:function(e,t){s({path:"connections[".concat(n,"].connectionType"),value:{key:t.key,text:t.text,color:t.color}}),i(Object(l.a)({},c,Object(z.a)({},n,{type:null})))}}),a.a.createElement(U,{read:p,write:m,onChange:function(e,t){s({path:"connections[".concat(n,"].").concat(e),value:t})}}),a.a.createElement(V.a,{iconProps:{iconName:"Delete"},onClick:function(){w()(o,"connections[".concat(n,"]"),null)&&s({path:"connections[".concat(n,"]"),type:"remove"}),t()}}))},$=function(e){var t=e.selectedKey,n=e.onChange,r=e.required,o=e.errorMessage;return a.a.createElement(B.a,{required:r,label:"System Type",options:[{key:"oncampus",text:"On Campus"},{key:"cloud",text:"Cloud"},{key:"external",text:"External"}],errorMessage:o,placeholder:"Where does this system live?",selectedKey:t,onChange:n})},ee=function(e,t){if(""===t.path)return{};var n=Object(l.a)({},e);switch(t.type){case"remove":return K()(n,t.path),n;default:return G()(n,t.path,t.value),n}},te=function(e,t){switch(t.type){case"add":var n=O()();return[].concat(Object(s.a)(e),[a.a.createElement(Z,{key:n,id:n,handleRemove:function(){return t.dispatch({type:"remove",id:n})}})]);case"remove":return e.filter(function(e){return e.key!==t.id});case"reset":return[];default:return e}},ne=function(){return h.getNodes().map(function(e){return{key:e.id,text:e.data.name}})},re=function(e){var t={};(e.type||(t.type="A system type must be selected"),e.name||(t.name="A system name is required"),e.connections)&&Object.keys(e.connections||{}).forEach(function(n){var r=w()(e,"connections[".concat(n,"].connectedTo.key"),null);w()(e,"connections[".concat(n,"].connectionType.key"),null)||G()(t,"[".concat(n,"].type"),"The connection must have a type selected"),r||G()(t,"[".concat(n,"].target"),"You must select another system to connect to")});return t},ae=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(ne()),u=Object(d.a)(i,2),s=u[0],f=u[1],p=Object(r.useState)({}),m=Object(d.a)(p,2),h=m[0],y=m[1],g=Object(r.useReducer)(te,[]),x=Object(d.a)(g,2),k=x[0],E=x[1],O=function(){return T({path:"",value:{}})},C=function(){return E({type:"reset"})};Object(r.useEffect)(function(){},[]);var S=function(){var e=Object(v.a)(b.a.mark(function e(){var t,n,r,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=re(F),console.log(F),!(Object.keys(t).length>0)){e.next=5;break}return y(Object(l.a)({},h,t)),e.abrupt("return");case 5:return n=w()(F,"connections",{}),r={description:w()(F,"description",""),name:w()(F,"name",""),type:w()(F,"type",""),url:w()(F,"url",""),department:w()(F,"department","")},a=j.makeNode({connections:n,data:r}),e.next=10,j.addNode(a);case 10:q(),C(),O();case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),A=Object(r.useReducer)(ee,{}),D=Object(d.a)(A,2),F=D[0],T=D[1];N("toggle-left-panel",function(){return c(!o)});var q=N("save-node-entry",function(){var e=ne();f(e)});return a.a.createElement(R.a,{headerText:"Add a New System Node",isOpen:o,onDismiss:function(){return c(!1)},type:I.a.medium},a.a.createElement(M.a,{label:"Name",placeholder:"Choose a name",errorMessage:h.name,required:!0,onGetErrorMessage:function(e){var t=String(e).toLowerCase();s.some(function(e){var n=e.text;return String(n).toLowerCase()===t})?y(Object(l.a)({},h,{name:"The ".concat(e," system already exists")})):y(Object(l.a)({},h,{name:null}))},onChange:function(e,t){return T({path:"name",value:t})},value:F.name||""}),a.a.createElement($,{required:!0,errorMessage:h.type,selectedKey:F.type||null,onChange:function(e,t){T({path:"type",value:t.key}),y(Object(l.a)({},h,{type:null}))}}),a.a.createElement(M.a,{label:"Department",placeholder:"Was this built for another department?",onChange:function(e,t){return T({path:"department",value:t})},value:F.department||""}),a.a.createElement(M.a,{label:"URL",placeholder:"Is there a url to access this system?",onChange:function(e,t){return T({path:"url",value:t})},value:F.url||""}),a.a.createElement(M.a,{label:"Description",placeholder:"Enter some information others may want to know about this system",multiline:!0,rows:4,onChange:function(e,t){return T({path:"description",value:t})},value:F.description||""}),function(e){var t=e.connections,n=e.existingSystems,r=e.addNodeForm,o=e.updateNodeForm,c=e.setNodeFormErrors,i=e.nodeFormErrors;return t.map(function(e){return a.a.cloneElement(e,{existingSystems:n,addNodeForm:r,updateNodeForm:o,setNodeFormErrors:c,nodeFormErrors:i})})}({connections:k,existingSystems:s,addNodeForm:F,updateNodeForm:T,setNodeFormErrors:y,nodeFormErrors:h}),a.a.createElement(_.a,{onClick:function(){E({type:"add",dispatch:E,existingSystems:s,addNodeForm:F,updateNodeForm:T})},iconProps:{iconName:"Add"}},"Add Connection"),a.a.createElement(W.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:12}},a.a.createElement(L.a,{text:"Cancel",onClick:function(){O(),C(),c(!1)}}),a.a.createElement(P.a,{text:"Add System",onClick:S})))},oe=n(162),ce=function(e){var t=e.to,n=e.type,r=e.read,o=e.write,c="";return r&&o?c="(Read and Write)":r?c="(Read)":o&&(c="(Write)"),a.a.createElement(oe.a,null,t," - ",n," ",c)},ie=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(null),u=Object(d.a)(i,2),s=u[0],l=u[1];N("display-node-details",function(e){l(e),c(!0)});var f=N("deselect-active-node"),p=w()(s,"name",""),m=w()(s,"description",""),y=function(e){if(!e)return[];var t=h.getEdges(),n=h.getNodesObject();return Object.keys(t||{}).reduce(function(r,o){return t[o].filter(function(t){return t.node===e.id}).forEach(function(e){var t=w()(n,"[".concat(o,"].data.name"));console.log(n);var c=w()(e,"data.type.label"),i=w()(e,"data.read"),u=w()(e,"data.write");r.push(a.a.createElement(ce,{to:t,read:i,write:u,type:c}))}),r},[])}(s);return a.a.createElement(R.a,{isOpen:o,onDismiss:function(){f(),c(!1)},isLightDismiss:!0,type:I.a.customNear,customWidth:400,headerText:p},a.a.createElement(W.a,{tokens:{childrenGap:8}},a.a.createElement(W.a,{tokens:{childrenGap:4}},a.a.createElement(oe.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Description"),a.a.createElement(oe.a,null,m)),a.a.createElement(W.a,null,a.a.createElement(oe.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Connections"),y)))};function ue(){var e=Object(i.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #e8e3db;\n"]);return ue=function(){return e},e}var se=u.a.div(ue());var de=function(){return a.a.createElement(se,null,a.a.createElement(T,null),a.a.createElement(ae,null),a.a.createElement(ie,null),a.a.createElement(D,null))};Object(c.a)(),Object(o.render)(a.a.createElement(de,null),document.getElementById("root"))}},[[109,1,2]]]);
//# sourceMappingURL=main.df021f38.chunk.js.map