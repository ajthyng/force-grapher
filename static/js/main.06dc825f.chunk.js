(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,n){e.exports=n(124)},124:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(45),c=n(154),i=n(46),u=n(52),s=n(30),d=n(12),l=n(16),f=n(94),p={},m={subscribe:function(e,t){p[e]||(p[e]=[]),p[e].push(t)},unsubscribe:function(e,t){p[e]&&(p[e]=p[e].filter(function(e){return e!==t}))},next:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];p[e]&&p[e].forEach(function(e){"function"===typeof e&&e.apply(void 0,n)})}};Object.freeze(m);var y=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t},t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))};return{getEdges:function(){return e("_edges",{})},getNodesObject:function(){return e("_nodes",{})},saveUploadedData:function(e){var n=e.edges,r=e.nodes;t("_edges",n),t("_nodes",r)},getNodes:function(){var t=e("_nodes",{});return Object.keys(t).reduce(function(e,n){return e.push(t[n]),e},[])}}}(),h=n(7),b=n.n(h),v=n(20),g=n(62),k=n.n(g),x=n(5),E=n.n(x),w=n(47),O=n.n(w),j=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t},t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},n=function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_edges",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),r=function(){var t=Object(v.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_nodes",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),a=function(){var e=Object(v.a)(b.a.mark(function e(n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.abrupt("return",t("_edges",n));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(v.a)(b.a.mark(function e(n){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t("_nodes",n));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(v.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to be added");case 2:return e.next=4,r();case 4:return(n=e.sent)[t.id]=t,e.next=8,f(t);case 8:return e.next=10,o(n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(v.a)(b.a.mark(function e(t,r,o){var c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),Array.isArray(c[r.id])||(c[r.id]=[]),c[t.id].push({node:r.id,data:o}),c[r.id].push({node:t.id,data:o}),e.next=11,a(Object(l.a)({},c));case 11:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),u=function(){var e=Object(v.a)(b.a.mark(function e(t,r,o){var c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add directed edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),c[t.id].push({node:r.id,data:o}),e.next=9,a(Object(l.a)({},c));case 9:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),s=function(){var e=Object(v.a)(b.a.mark(function e(t){var r,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to remove directed eges");case 2:return e.next=4,n();case 4:return r=e.sent,o=k()(r,t.id),e.next=8,a(o);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(v.a)(b.a.mark(function e(t,r){var o,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to remove edges");case 2:return e.next=4,n();case 4:return o=e.sent,c=k()(o,[t.id,r.id]),e.next=8,a(c);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(v.a)(b.a.mark(function e(t){var n,r,a,o,c,s,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=E()(t,"edges",[])).length<=0)){e.next=3;break}return e.abrupt("return");case 3:r=0;case 4:if(!(r<n.length)){e.next=26;break}if(a=n[r],o=E()(a,"data.read"),c=E()(a,"data.write"),s={id:E()(t,"id")},d={id:E()(a,"id")},!o||!c){e.next=15;break}return e.next=13,i(s,d,E()(a,"data"));case 13:e.next=23;break;case 15:if(!o){e.next=20;break}return e.next=18,u(d,s,E()(a,"data"));case 18:e.next=23;break;case 20:if(!c){e.next=23;break}return e.next=23,u(s,d,E()(a,"data"));case 23:r++,e.next=4;break;case 26:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return{addNode:c,removeEdge:d,removeDirectedEdge:s,makeNode:function(e){var t=e.data,n=e.connections,r={id:O()(),edges:[],data:Object(l.a)({},t||{})},a=Object.keys(n||{});return a.length<=0?r:(a.forEach(function(e){var t=E()(n,"".concat([e],".connectedTo"),null);if(!t)throw new Error("You cannot make a connection without a target");var a=E()(n,"".concat([e],".connectionType"),null);if(!a)throw new Error("You cannot make a connection without a type");var o=E()(n,"".concat([e],".read"),null),c=E()(n,"".concat([e],".write"),null);if(!o&&!c)throw new Error("You must specify a read or a write option");var i=E()(n,"[".concat(e,"].data"),{});r.edges.push({id:t.key,data:Object(l.a)({},i,{read:o,write:c,type:{id:a.key,label:a.text}})})}),r)}}}(),N=function(e,t){return Object(r.useEffect)(function(){if("function"===typeof t)return m.subscribe(e,t),function(){return m.unsubscribe(e,t)}},[e,t]),function(t){return m.next(e,t)}},C=function(e,t){switch(t.type){case"update":var n=y.getNodes(),r=y.getEdges();return A(n,r);default:return e}},S=function(e){switch(e){case"custom":return"#4b721d";case"builtin":return"#deb407";default:return"#A0A0A0"}},A=function(e,t){var n={nodes:[],links:[]};return Array.isArray(e)?(Object.keys(e||{}).forEach(function(t){var r=e[t];console.log(r),n.nodes.push({id:r.id,type:r.data.type,name:r.data.name,data:Object(l.a)({},r.data),color:"#303030"})}),Object.keys(t||{}).forEach(function(e){t[e].forEach(function(t){n.links.push({source:e,target:t.node,color:S(E()(t,"data.type.id")),type:E()(t,"data.type",{})})})}),n):{nodes:[],links:[]}},D=function(e){var t=Object(r.useReducer)(C,A(y.getNodes(),y.getEdges())),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(),u=Object(d.a)(i,2),l=u[0],p=u[1],m=Object(r.useRef)(),h=N("display-node-details");return Object(r.useEffect)(function(){m.current.d3Force("charge").strength(-150),m.current.zoom(4)},[o.links]),Object(r.useEffect)(function(){l&&h(l)},[l,h]),N("save-node-entry",function(){c({type:"update"})}),N("deselect-active-node",function(){return p(null)}),a.a.createElement(f.a,{ref:m,graphData:o,linkDirectionalArrowLength:5,linkDirectionalArrowRelPos:.5,linkCurvature:.25,linkColor:function(e){return e.color},nodeVal:4.5,onNodeClick:function(e){e.id!==E()(l,"id",null)?p(e):p(null)},nodeCanvasObject:function(e,t,n){var r=E()(l,"id",null)===e.id,a=e.name,o=16/n;t.font="".concat(r?"bold ":"").concat(o,"px Sans-Serif");var c=t.measureText(a).width,i=[c,o].map(function(e){return e+3*o}),u=[c,o].map(function(e){return e+o*(r?3.4:3.2)});return t.fillStyle=r?"#005481":e.color,t.fillRect.apply(t,[e.x-u[0]/2,e.y-u[1]/2].concat(Object(s.a)(u))),t.fillStyle="rgba(255, 255, 255, 1)",t.fillRect.apply(t,[e.x-i[0]/2,e.y-i[1]/2].concat(Object(s.a)(i))),t.textAlign="center",t.textBaseline="middle",t.fillStyle=r?"#005481":e.color,t.fillText(a,e.x,e.y),t}})},F=n(155),R=n(82),T=n.n(R),I=function(e){var t=new FileReader;t.readAsBinaryString(e.target.files[0]),t.onloadend=Object(v.a)(b.a.mark(function e(){var n,r,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=JSON.parse(t.result),r=E()(n,"edges",{}),a=E()(n,"nodes",{}),y.saveUploadedData({edges:r,nodes:a}),m.next("save-node-entry");case 5:case"end":return e.stop()}},e)}))},P=function(e){var t=[{key:"addNode",name:"Add System",iconProps:{iconName:"Add"},onClick:N("toggle-left-panel")},{key:"upload",name:"Upload",iconProps:{iconName:"Upload"},onClick:function(){!function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept",".json"),e.style.display="none",e.addEventListener("change",I),e.click()}()}},{key:"download",name:"Download",iconProps:{iconName:"Download"},onClick:function(){var e=y.getEdges(),t=y.getNodesObject();!function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(t))),n.setAttribute("download","".concat(e," - ").concat(T()().format("YYYY-MM-DD/THHmmss"),".json")),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("TR_Systems",JSON.stringify({edges:e,nodes:t},null,2))}}];return a.a.createElement(F.a,{items:t})},_=n(159),M=n(14),J=n(160),L=n(162),U=n(98),Y=n(95),G=n(153),W=n(54),q=n.n(W),B=n(90),K=n.n(B),z=n(38),H=n(158),V=n(164),Q=function(e,t){return function(n,r){return"read"===e?t||r||!1:"write"===e&&(t||n)||!1}},X=function(e){var t=e.read,n=e.write,r=e.onChange;return a.a.createElement(L.a,{style:{marginRight:8,marginLeft:8,alignSelf:"center"},verticalAlign:"space-between",tokens:{childrenGap:4}},a.a.createElement(V.a,{checked:t,onChange:function(e,a){Q("read",a)(t,n)&&r("read",a)},label:"Read"}),a.a.createElement(V.a,{checked:n,onChange:function(e,a){Q("write",a)(t,n)&&r("write",a)},label:"Write"}))},Z=n(169);function $(){var e=Object(i.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  padding-top: 16px;\n\n  & > .ms-Dropdown-container {\n    flex: 1;\n    margin-right: 4px;\n  }\n\n  & > .ms-Button--icon {\n    align-self: flex-end;\n  }\n"]);return $=function(){return e},e}var ee=u.a.div($()),te=function(e){var t=e.handleRemove,n=e.id,o=e.addNodeForm,c=e.nodeFormErrors,i=e.setNodeFormErrors,u=e.existingSystems,s=e.updateNodeForm,d=E()(o,"connections[".concat(n,"].connectedTo.key"),null),f=E()(o,"connections[".concat(n,"].connectionType.key"),null),p=E()(o,"connections[".concat(n,"].read"),!0),m=E()(o,"connections[".concat(n,"].write"),!1),y=E()(c,"[".concat(n,"].target")),h=E()(c,"[".concat(n,"].type"));return Object(r.useEffect)(function(){s({path:"connections[".concat(n,"].read"),value:!0})},[s,n]),a.a.createElement(ee,null,a.a.createElement(H.a,{label:"Connected To",placeholder:"What does ".concat(o.name||"this system"," connect to?"),options:u,errorMessage:y,selectedKey:d,onChange:function(e,t){s({path:"connections[".concat(n,"].connectedTo"),value:{key:t.key,text:t.text}}),i(Object(l.a)({},c,Object(z.a)({},n,{type:null})))}}),a.a.createElement(H.a,{label:"Interface",options:[{key:"builtin",text:"Built In"},{key:"custom",text:"Custom"}],placeholder:"How does this system connect?",selectedKey:f,errorMessage:h,onChange:function(e,t){s({path:"connections[".concat(n,"].connectionType"),value:{key:t.key,text:t.text,color:t.color}}),i(Object(l.a)({},c,Object(z.a)({},n,{type:null})))}}),a.a.createElement(X,{read:p,write:m,onChange:function(e,t){s({path:"connections[".concat(n,"].").concat(e),value:t})}}),a.a.createElement(Z.a,{iconProps:{iconName:"Delete"},onClick:function(){E()(o,"connections[".concat(n,"]"),null)&&s({path:"connections[".concat(n,"]"),type:"remove"}),t()}}))},ne=function(e){var t=e.selectedKey,n=e.onChange,r=e.required,o=e.errorMessage;return a.a.createElement(H.a,{required:r,label:"System Type",options:[{key:"oncampus",text:"On Campus"},{key:"cloud",text:"Cloud"},{key:"external",text:"External"}],errorMessage:o,placeholder:"Where does this system live?",selectedKey:t,onChange:n})},re=function(e,t){if(""===t.path)return{};var n=Object(l.a)({},e);switch(t.type){case"remove":return K()(n,t.path),n;default:return q()(n,t.path,t.value),n}},ae=function(e,t){switch(t.type){case"add":var n=O()();return[].concat(Object(s.a)(e),[a.a.createElement(te,{key:n,id:n,handleRemove:function(){return t.dispatch({type:"remove",id:n})}})]);case"remove":return e.filter(function(e){return e.key!==t.id});case"reset":return[];default:return e}},oe=function(){return y.getNodes().map(function(e){return{key:e.id,text:e.data.name}})},ce=function(e){var t={};(e.type||(t.type="A system type must be selected"),e.name||(t.name="A system name is required"),e.connections)&&Object.keys(e.connections||{}).forEach(function(n){var r=E()(e,"connections[".concat(n,"].connectedTo.key"),null);E()(e,"connections[".concat(n,"].connectionType.key"),null)||q()(t,"[".concat(n,"].type"),"The connection must have a type selected"),r||q()(t,"[".concat(n,"].target"),"You must select another system to connect to")});return t},ie=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(oe()),u=Object(d.a)(i,2),s=u[0],f=u[1],p=Object(r.useState)({}),m=Object(d.a)(p,2),y=m[0],h=m[1],g=Object(r.useReducer)(ae,[]),k=Object(d.a)(g,2),x=k[0],w=k[1],O=function(){return R({path:"",value:{}})},C=function(){return w({type:"reset"})};Object(r.useEffect)(function(){},[]);var S=function(){var e=Object(v.a)(b.a.mark(function e(){var t,n,r,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ce(F),console.log(F),!(Object.keys(t).length>0)){e.next=5;break}return h(Object(l.a)({},y,t)),e.abrupt("return");case 5:return n=E()(F,"connections",{}),r={description:E()(F,"description",""),name:E()(F,"name",""),type:E()(F,"type",""),url:E()(F,"url",""),department:E()(F,"department","")},a=j.makeNode({connections:n,data:r}),e.next=10,j.addNode(a);case 10:T(),C(),O();case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),A=Object(r.useReducer)(re,{}),D=Object(d.a)(A,2),F=D[0],R=D[1];N("toggle-left-panel",function(){return c(!o)});var T=N("save-node-entry",function(){var e=oe();f(e)});return a.a.createElement(_.a,{headerText:"Add a New System Node",isOpen:o,onDismiss:function(){return c(!1)},type:M.a.medium},a.a.createElement(J.a,{label:"Name",placeholder:"Choose a name",errorMessage:y.name,required:!0,onGetErrorMessage:function(e){var t=String(e).toLowerCase();s.some(function(e){var n=e.text;return String(n).toLowerCase()===t})?h(Object(l.a)({},y,{name:"The ".concat(e," system already exists")})):h(Object(l.a)({},y,{name:null}))},onChange:function(e,t){return R({path:"name",value:t})},value:F.name||""}),a.a.createElement(ne,{required:!0,errorMessage:y.type,selectedKey:F.type||null,onChange:function(e,t){R({path:"type",value:t.key}),h(Object(l.a)({},y,{type:null}))}}),a.a.createElement(J.a,{label:"Department",placeholder:"Was this built for another department?",onChange:function(e,t){return R({path:"department",value:t})},value:F.department||""}),a.a.createElement(J.a,{label:"URL",placeholder:"Is there a url to access this system?",onChange:function(e,t){return R({path:"url",value:t})},value:F.url||""}),a.a.createElement(J.a,{label:"Description",placeholder:"Enter some information others may want to know about this system",multiline:!0,rows:4,onChange:function(e,t){return R({path:"description",value:t})},value:F.description||""}),function(e){var t=e.connections,n=e.existingSystems,r=e.addNodeForm,o=e.updateNodeForm,c=e.setNodeFormErrors,i=e.nodeFormErrors;return t.map(function(e){return a.a.cloneElement(e,{existingSystems:n,addNodeForm:r,updateNodeForm:o,setNodeFormErrors:c,nodeFormErrors:i})})}({connections:x,existingSystems:s,addNodeForm:F,updateNodeForm:R,setNodeFormErrors:h,nodeFormErrors:y}),a.a.createElement(U.a,{onClick:function(){w({type:"add",dispatch:w,existingSystems:s,addNodeForm:F,updateNodeForm:R})},iconProps:{iconName:"Add"}},"Add Connection"),a.a.createElement(L.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:12}},a.a.createElement(Y.a,{text:"Cancel",onClick:function(){O(),C(),c(!1)}}),a.a.createElement(G.a,{text:"Add System",onClick:S})))},ue=n(163),se=function(e){var t=e.to,n=e.type,r=e.read,o=e.write,c="";return r&&o?c="(Read and Write)":r?c="(Read)":o&&(c="(Write)"),a.a.createElement(ue.a,null,t," - ",n," ",c)},de=function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(null),u=Object(d.a)(i,2),s=u[0],l=u[1];N("display-node-details",function(e){l(e),c(!0)});var f=N("deselect-active-node"),p=E()(s,"name","Very Unnamed System"),m=E()(s,"data.description","No description has been entered."),h=E()(s,"data.department","No department has been entered."),b=E()(s,"data.url","".concat(p," has no url")),v=function(e){if(!e)return[];var t=y.getEdges(),n=y.getNodesObject();return Object.keys(t||{}).reduce(function(r,o){return t[o].filter(function(t){return t.node===e.id}).forEach(function(e){var t=E()(n,"[".concat(o,"].data.name")),c=E()(e,"data.type.label"),i=E()(e,"data.read"),u=E()(e,"data.write");r.push(a.a.createElement(se,{to:t,read:i,write:u,type:c}))}),r},[])}(s);return a.a.createElement(_.a,{isOpen:o,onDismiss:function(){f(),c(!1)},isLightDismiss:!0,type:M.a.customNear,customWidth:400,headerText:p},a.a.createElement(L.a,{tokens:{childrenGap:8}},a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Description"),a.a.createElement(ue.a,null,m)),a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Department"),a.a.createElement(ue.a,null,h)),a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"URL"),a.a.createElement(ue.a,null,b)),a.a.createElement(L.a,null,a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Connections"),v)))};function le(){var e=Object(i.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #e8e3db;\n"]);return le=function(){return e},e}var fe=u.a.div(le());var pe=function(){return a.a.createElement(fe,null,a.a.createElement(P,null),a.a.createElement(ie,null),a.a.createElement(de,null),a.a.createElement(D,null))};Object(c.a)(),Object(o.render)(a.a.createElement(pe,null),document.getElementById("root"))}},[[110,1,2]]]);
//# sourceMappingURL=main.06dc825f.chunk.js.map