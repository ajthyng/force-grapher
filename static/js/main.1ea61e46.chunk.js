(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){e.exports=n(113)},113:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(41),c=n(143),i=n(42),u=n(48),s=n(20),d=n(13),l=n(50),f={},p={subscribe:function(e,t){f[e]||(f[e]=[]),f[e].push(t)},unsubscribe:function(e,t){f[e]&&(f[e]=f[e].filter(function(e){return e!==t}))},next:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];f[e]&&f[e].forEach(function(e){"function"===typeof e&&e.apply(void 0,n)})}};Object.freeze(p);var m=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t},t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))};return{getEdges:function(){return e("_edges",{})},getNodesObject:function(){return e("_nodes",{})},saveUploadedData:function(e){var n=e.edges,r=e.nodes;t("_edges",n),t("_nodes",r)},getNodes:function(){var t=e("_nodes",{});return Object.keys(t).reduce(function(e,n){return e.push(t[n]),e},[])}}}(),h=n(8),y=n.n(h),b=n(17),v=n(58),g=n.n(v),w=n(4),x=n.n(w),E=n(43),k=n.n(E),O=function(){var e=function(e,t){return JSON.parse(localStorage.getItem(e))||t},t=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},n=function(){var t=Object(b.a)(y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_edges",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),r=function(){var t=Object(b.a)(y.a.mark(function t(){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e("_nodes",{}));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),a=function(){var e=Object(b.a)(y.a.mark(function e(n){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.abrupt("return",t("_edges",n));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o=function(){var e=Object(b.a)(y.a.mark(function e(n){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t("_nodes",n));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(b.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to be added");case 2:return e.next=4,r();case 4:return(n=e.sent)[t.id]=t,e.next=8,f(t);case 8:return e.next=10,o(n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(b.a)(y.a.mark(function e(t,r,o){var c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),Array.isArray(c[r.id])||(c[r.id]=[]),c[t.id].push({node:r.id,data:o}),c[r.id].push({node:t.id,data:o}),e.next=11,a(Object(d.a)({},c));case 11:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),u=function(){var e=Object(b.a)(y.a.mark(function e(t,r,o){var c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to add directed edges");case 2:return e.next=4,n();case 4:return c=e.sent,Array.isArray(c[t.id])||(c[t.id]=[]),c[t.id].push({node:r.id,data:o}),e.next=9,a(Object(d.a)({},c));case 9:case"end":return e.stop()}},e)}));return function(t,n,r){return e.apply(this,arguments)}}(),s=function(){var e=Object(b.a)(y.a.mark(function e(t){var r,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error("Nodes must have IDs to remove directed eges");case 2:return e.next=4,n();case 4:return r=e.sent,o=g()(r,t.id),e.next=8,a(o);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(b.a)(y.a.mark(function e(t,r){var o,c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id&&r.id){e.next=2;break}throw new Error("Nodes must have IDs to remove edges");case 2:return e.next=4,n();case 4:return o=e.sent,c=g()(o,[t.id,r.id]),e.next=8,a(c);case 8:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(b.a)(y.a.mark(function e(t){var n,r,a,o,c,s,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=x()(t,"edges",[])).length<=0)){e.next=3;break}return e.abrupt("return");case 3:r=0;case 4:if(!(r<n.length)){e.next=26;break}if(a=n[r],o=x()(a,"data.read"),c=x()(a,"data.write"),s={id:x()(t,"id")},d={id:x()(a,"id")},!o||!c){e.next=15;break}return e.next=13,i(s,d,x()(a,"data"));case 13:e.next=23;break;case 15:if(!o){e.next=20;break}return e.next=18,u(d,s,x()(a,"data"));case 18:e.next=23;break;case 20:if(!c){e.next=23;break}return e.next=23,u(s,d,x()(a,"data"));case 23:r++,e.next=4;break;case 26:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return{addNode:c,removeEdge:l,removeDirectedEdge:s,makeNode:function(e){var t=e.data,n=e.connections,r={id:k()(),edges:[],data:Object(d.a)({},t||{})},a=Object.keys(n||{});return a.length<=0?r:(a.forEach(function(e){var t=x()(n,"".concat([e],".connectedTo"),null);if(!t)throw new Error("You cannot make a connection without a target");var a=x()(n,"".concat([e],".connectionType"),null);if(!a)throw new Error("You cannot make a connection without a type");var o=x()(n,"".concat([e],".read"),null),c=x()(n,"".concat([e],".write"),null);if(!o&&!c)throw new Error("You must specify a read or a write option");var i=x()(n,"[".concat(e,"].data"),{});r.edges.push({id:t.key,data:Object(d.a)({},i,{read:o,write:c,type:{id:a.key,label:a.text}})})}),r)}}}(),j=function(e,t){return Object(r.useEffect)(function(){if("function"===typeof t)return p.subscribe(e,t),function(){return p.unsubscribe(e,t)}},[e,t]),function(t){return p.next(e,t)}},N=function(e,t){switch(t.type){case"update":var n=m.getNodes(),r=m.getEdges();return S(n,r);default:return e}},C=function(e){switch(e){case"custom":return"#4b721d";case"builtin":return"#deb407";default:return"#A0A0A0"}},S=function(e,t){var n={nodes:[],edges:[]};return Array.isArray(e)?(Object.keys(e||{}).forEach(function(t){var r=e[t];n.nodes.push(Object(d.a)({id:r.id,type:r.data.type},function(e){switch(e){case"cloud":return{size:40,widthConstraint:{minimum:40,maximum:100}};case"external":return{shape:"circle",size:40,widthConstraint:{minimum:40,maximum:100}};case"oncampus":default:return{shape:"box",size:40,widthConstraint:{minimum:40,maximum:100}}}}(r.data.type),{label:r.data.name,data:Object(d.a)({},r.data),color:"#FFFFFF"}))}),Object.keys(t||{}).forEach(function(e){t[e].forEach(function(t){n.edges.push({from:e,to:t.node,color:C(x()(t,"data.type.id")),type:x()(t,"data.type",{}),arrows:"to"})})}),n):{nodes:[],edges:[]}},A=function(e){var t=Object(r.useReducer)(N,S(m.getNodes(),m.getEdges())),n=Object(s.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(),u=Object(s.a)(i,2),d=u[0],f=u[1],p=Object(r.useRef)(),h=Object(r.useRef)(),y=j("display-node-details");return Object(r.useEffect)(function(){d&&y(d)},[d,y]),j("save-node-entry",function(){c({type:"update"})}),j("deselect-active-node",function(){return f(null)}),Object(r.useEffect)(function(){var e={nodes:new l.a(o.nodes),edges:new l.a(o.edges)};p.current?p.current.setData(e):(p.current=new l.b(h.current,e,{physics:{solver:"repulsion"}}),p.current.on("oncontext",function(e){var t=p.current.getNodeAt(e.pointer.DOM);if(p.current.isCluster(t))p.current.openCluster(t);else{var n=o.nodes.find(function(e){return e.id===t});if(!n)return;p.current.clusterByConnection(t,{clusterNodeProperties:{label:n.data.name}})}}),p.current.on("selectNode",function(e){var t=x()(e,"nodes[0]",null);t&&(p.current.isCluster(t)||f(t))}),document.addEventListener("contextmenu",function(e){return e.preventDefault()},!1))},[o]),a.a.createElement("div",{style:{height:"100%"},ref:h,id:"graph"})},D=n(144),F=n(72),R=n.n(F),T=function(e){var t=new FileReader;t.readAsBinaryString(e.target.files[0]),t.onloadend=Object(b.a)(y.a.mark(function e(){var n,r,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=JSON.parse(t.result),r=x()(n,"edges",{}),a=x()(n,"nodes",{}),m.saveUploadedData({edges:r,nodes:a}),p.next("save-node-entry");case 5:case"end":return e.stop()}},e)}))},I=function(e){var t=[{key:"addNode",name:"Add System",iconProps:{iconName:"Add"},onClick:j("toggle-left-panel")},{key:"upload",name:"Upload",iconProps:{iconName:"Upload"},onClick:function(){!function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept",".json"),e.style.display="none",e.addEventListener("change",T),e.click()}()}},{key:"download",name:"Download",iconProps:{iconName:"Download"},onClick:function(){var e=m.getEdges(),t=m.getNodesObject();!function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,".concat(encodeURIComponent(t))),n.setAttribute("download","".concat(e," - ").concat(R()().format("YYYY-MM-DD/THHmmss"),".json")),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("TR_Systems",JSON.stringify({edges:e,nodes:t},null,2))}}];return a.a.createElement(D.a,{items:t})},M=n(84),P=n(148),_=n(11),J=n(149),L=n(151),U=n(88),Y=n(85),G=n(142),W=n(51),z=n.n(W),q=n(80),B=n.n(q),K=n(34),H=n(147),V=n(153),Q=function(e,t){return function(n,r){return"read"===e?t||r||!1:"write"===e&&(t||n)||!1}},X=function(e){var t=e.read,n=e.write,r=e.onChange;return a.a.createElement(L.a,{style:{marginRight:8,marginLeft:8,alignSelf:"center"},verticalAlign:"space-between",tokens:{childrenGap:4}},a.a.createElement(V.a,{checked:t,onChange:function(e,a){Q("read",a)(t,n)&&r("read",a)},label:"Read"}),a.a.createElement(V.a,{checked:n,onChange:function(e,a){Q("write",a)(t,n)&&r("write",a)},label:"Write"}))},Z=n(158);function $(){var e=Object(i.a)(["\n  display: flex;\n  align-items: flex-start;\n  justify-content: space-between;\n  padding-top: 16px;\n\n  & > .ms-Dropdown-container {\n    flex: 1;\n    margin-right: 4px;\n  }\n\n  & > .ms-Button--icon {\n    align-self: flex-end;\n  }\n"]);return $=function(){return e},e}var ee=u.a.div($()),te=function(e){var t=e.handleRemove,n=e.id,o=e.addNodeForm,c=e.nodeFormErrors,i=e.setNodeFormErrors,u=e.existingSystems,s=e.updateNodeForm,l=x()(o,"connections[".concat(n,"].connectedTo.key"),null),f=x()(o,"connections[".concat(n,"].connectionType.key"),null),p=x()(o,"connections[".concat(n,"].read"),!0),m=x()(o,"connections[".concat(n,"].write"),!1),h=x()(c,"[".concat(n,"].target")),y=x()(c,"[".concat(n,"].type"));return Object(r.useEffect)(function(){s({path:"connections[".concat(n,"].read"),value:!0})},[s,n]),a.a.createElement(ee,null,a.a.createElement(H.a,{label:"Connected To",placeholder:"What does ".concat(o.name||"this system"," connect to?"),options:u,errorMessage:h,selectedKey:l,onChange:function(e,t){s({path:"connections[".concat(n,"].connectedTo"),value:{key:t.key,text:t.text}}),i(Object(d.a)({},c,Object(K.a)({},n,{type:null})))}}),a.a.createElement(H.a,{label:"Interface",options:[{key:"builtin",text:"Built In"},{key:"custom",text:"Custom"}],placeholder:"How does this system connect?",selectedKey:f,errorMessage:y,onChange:function(e,t){s({path:"connections[".concat(n,"].connectionType"),value:{key:t.key,text:t.text,color:t.color}}),i(Object(d.a)({},c,Object(K.a)({},n,{type:null})))}}),a.a.createElement(X,{read:p,write:m,onChange:function(e,t){s({path:"connections[".concat(n,"].").concat(e),value:t})}}),a.a.createElement(Z.a,{iconProps:{iconName:"Delete"},onClick:function(){x()(o,"connections[".concat(n,"]"),null)&&s({path:"connections[".concat(n,"]"),type:"remove"}),t()}}))},ne=function(e){var t=e.selectedKey,n=e.onChange,r=e.required,o=e.errorMessage;return a.a.createElement(H.a,{required:r,label:"System Type",options:[{key:"oncampus",text:"On Campus"},{key:"cloud",text:"Cloud"},{key:"external",text:"External"}],errorMessage:o,placeholder:"Where does this system live?",selectedKey:t,onChange:n})},re=function(e,t){if(""===t.path)return{};var n=Object(d.a)({},e);switch(t.type){case"remove":return B()(n,t.path),n;default:return z()(n,t.path,t.value),n}},ae=function(e,t){switch(t.type){case"add":var n=k()();return[].concat(Object(M.a)(e),[a.a.createElement(te,{key:n,id:n,handleRemove:function(){return t.dispatch({type:"remove",id:n})}})]);case"remove":return e.filter(function(e){return e.key!==t.id});case"reset":return[];default:return e}},oe=function(){return m.getNodes().map(function(e){return{key:e.id,text:e.data.name}})},ce=function(e){var t={};(e.type||(t.type="A system type must be selected"),e.name||(t.name="A system name is required"),e.connections)&&Object.keys(e.connections||{}).forEach(function(n){var r=x()(e,"connections[".concat(n,"].connectedTo.key"),null);x()(e,"connections[".concat(n,"].connectionType.key"),null)||z()(t,"[".concat(n,"].type"),"The connection must have a type selected"),r||z()(t,"[".concat(n,"].target"),"You must select another system to connect to")});return t},ie=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(oe()),u=Object(s.a)(i,2),l=u[0],f=u[1],p=Object(r.useState)({}),m=Object(s.a)(p,2),h=m[0],v=m[1],g=Object(r.useReducer)(ae,[]),w=Object(s.a)(g,2),E=w[0],k=w[1],N=function(){return R({path:"",value:{}})},C=function(){return k({type:"reset"})};Object(r.useEffect)(function(){},[]);var S=function(){var e=Object(b.a)(y.a.mark(function e(){var t,n,r,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=ce(F),console.log(F),!(Object.keys(t).length>0)){e.next=5;break}return v(Object(d.a)({},h,t)),e.abrupt("return");case 5:return n=x()(F,"connections",{}),r={description:x()(F,"description",""),name:x()(F,"name",""),type:x()(F,"type",""),url:x()(F,"url",""),department:x()(F,"department","")},a=O.makeNode({connections:n,data:r}),e.next=10,O.addNode(a);case 10:T(),C(),N();case 13:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),A=Object(r.useReducer)(re,{}),D=Object(s.a)(A,2),F=D[0],R=D[1];j("toggle-left-panel",function(){return c(!o)});var T=j("save-node-entry",function(){var e=oe();f(e)});return a.a.createElement(P.a,{headerText:"Add a New System Node",isOpen:o,onDismiss:function(){return c(!1)},type:_.a.medium},a.a.createElement(J.a,{label:"Name",placeholder:"Choose a name",errorMessage:h.name,required:!0,onGetErrorMessage:function(e){var t=String(e).toLowerCase();l.some(function(e){var n=e.text;return String(n).toLowerCase()===t})?v(Object(d.a)({},h,{name:"The ".concat(e," system already exists")})):v(Object(d.a)({},h,{name:null}))},onChange:function(e,t){return R({path:"name",value:t})},value:F.name||""}),a.a.createElement(ne,{required:!0,errorMessage:h.type,selectedKey:F.type||null,onChange:function(e,t){R({path:"type",value:t.key}),v(Object(d.a)({},h,{type:null}))}}),a.a.createElement(J.a,{label:"Department",placeholder:"Was this built for another department?",onChange:function(e,t){return R({path:"department",value:t})},value:F.department||""}),a.a.createElement(J.a,{label:"URL",placeholder:"Is there a url to access this system?",onChange:function(e,t){return R({path:"url",value:t})},value:F.url||""}),a.a.createElement(J.a,{label:"Description",placeholder:"Enter some information others may want to know about this system",multiline:!0,rows:4,onChange:function(e,t){return R({path:"description",value:t})},value:F.description||""}),function(e){var t=e.connections,n=e.existingSystems,r=e.addNodeForm,o=e.updateNodeForm,c=e.setNodeFormErrors,i=e.nodeFormErrors;return t.map(function(e){return a.a.cloneElement(e,{existingSystems:n,addNodeForm:r,updateNodeForm:o,setNodeFormErrors:c,nodeFormErrors:i})})}({connections:E,existingSystems:l,addNodeForm:F,updateNodeForm:R,setNodeFormErrors:v,nodeFormErrors:h}),a.a.createElement(U.a,{onClick:function(){k({type:"add",dispatch:k,existingSystems:l,addNodeForm:F,updateNodeForm:R})},iconProps:{iconName:"Add"}},"Add Connection"),a.a.createElement(L.a,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:12}},a.a.createElement(Y.a,{text:"Cancel",onClick:function(){N(),C(),c(!1)}}),a.a.createElement(G.a,{text:"Add System",onClick:S})))},ue=n(152),se=function(e){var t=e.to,n=e.type,r=e.read,o=e.write,c="";return r&&o?c="(Read and Write)":r?c="(Read)":o&&(c="(Write)"),a.a.createElement(ue.a,null,t," - ",n," ",c)},de=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),o=n[0],c=n[1],i=Object(r.useState)(null),u=Object(s.a)(i,2),d=u[0],l=u[1];j("display-node-details",function(e){l(e),c(!0)});var f=j("deselect-active-node"),p=x()(d,"name","Very Unnamed System"),h=x()(d,"data.description","No description has been entered."),y=x()(d,"data.department","No department has been entered."),b=x()(d,"data.url","".concat(p," has no url")),v=function(e){if(!e)return[];var t=m.getEdges(),n=m.getNodesObject();return Object.keys(t||{}).reduce(function(r,o){return t[o].filter(function(t){return t.node===e.id}).forEach(function(e){var t=x()(n,"[".concat(o,"].data.name")),c=x()(e,"data.type.label"),i=x()(e,"data.read"),u=x()(e,"data.write");r.push(a.a.createElement(se,{to:t,read:i,write:u,type:c}))}),r},[])}(d);return a.a.createElement(P.a,{isOpen:o,onDismiss:function(){f(),c(!1)},isLightDismiss:!0,type:_.a.customNear,customWidth:400,headerText:p},a.a.createElement(L.a,{tokens:{childrenGap:8}},a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Description"),a.a.createElement(ue.a,null,h)),a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Department"),a.a.createElement(ue.a,null,y)),a.a.createElement(L.a,{tokens:{childrenGap:4}},a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"URL"),a.a.createElement(ue.a,null,b)),a.a.createElement(L.a,null,a.a.createElement(ue.a,{style:{textDecoration:"underline"},variant:"mediumPlus"},"Connections"),v)))};function le(){var e=Object(i.a)(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: #e8e3db;\n"]);return le=function(){return e},e}var fe=u.a.div(le());var pe=function(){return a.a.createElement(fe,null,a.a.createElement(I,null),a.a.createElement(ie,null),a.a.createElement(de,null),a.a.createElement(A,null))};Object(c.a)(),Object(o.render)(a.a.createElement(pe,null),document.getElementById("root"))}},[[100,1,2]]]);
//# sourceMappingURL=main.1ea61e46.chunk.js.map