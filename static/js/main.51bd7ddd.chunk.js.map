{"version":3,"sources":["components/Legend/Legend.js","util/Subject.js","util/Graph.js","util/Network.js","hooks/useEvent.js","hooks/useEventListener.js","components/SystemsGraph/SystemsGraph.js","util/FileManager.js","components/CommandBar/CommandBar.js","components/SystemForm/ConnectionReadWrite.js","components/SystemForm/Connection.js","components/SystemForm/SystemType.js","components/SystemForm/SystemFormView.js","components/SystemForm/SystemForm.js","components/NodeDetail/NodeDetailView.js","components/NodeDetail/NodeDetail.js","components/Loading/Loading.js","components/DiagramForm/DiagramFormView.js","components/DiagramForm/DiagramForm.js","components/DiagramBrowser/DiagramList.js","components/DiagramBrowser/DiagramBrowserView.js","components/DiagramBrowser/DiagramBrowser.js","components/DiagramTitle/DiagramTitle.js","components/Layout/Layout.js","App.js","index.js"],"names":["LegendContainer","styled","div","_templateObject","LegendIcon","i","_templateObject2","OnCampus","attrs","props","className","_templateObject3","External","_templateObject4","Cloud","_templateObject5","NodeContainer","_templateObject6","Label","span","_templateObject7","CircleBox","_templateObject8","Circle","_templateObject9","Node","Icon","icon","react_default","a","createElement","label","CircleNode","EdgeContainer","_templateObject10","EdgeStyle","_templateObject11","_ref","dashed","_ref2","color","EdgeStyleContainer","_templateObject12","Edge","Legend","Legend_CircleNode","Legend_Node","Legend_Edge","_handlers","Subject","subscribe","event","handler","push","unsubscribe","filter","func","next","_len","arguments","length","args","Array","_key","forEach","apply","Object","freeze","Graph","_get","key","defaultValue","value","localStorage","getItem","JSON","parse","err","_set","setItem","stringify","fixEdges","oldEdges","edges","objectSpread","edgeKeys","keys","didFix","nodeEdges","currentEdgeID","edge","node","otherEdges","otherEdgeIndex","findIndex","splice","updateNodePosition","asyncToGenerator","regenerator_default","mark","_callee","x","y","nodes","wrap","_context","prev","getNodes","sent","position","abrupt","setNodes","stop","_x","this","updateBatchNodePositions","_ref3","_callee2","existingNodes","_context2","entries","_ref4","_ref5","slicedToArray","_ref5$","_x2","getEdges","_ref6","_callee3","current","_edges","_fixEdges","_edges2","_context3","getCurrentDiagram","updateDiagrams","removeItem","get","setEdges","getNodesArray","_ref7","_callee4","_context4","values","_ref8","_callee5","_context5","_nodes","getDiagrams","_ref9","_callee6","_context6","_ref10","_callee7","diagram","diagrams","_context7","_id","_x3","_ref11","_callee8","_context8","_x4","_ref12","_callee9","_context9","_x5","addNode","_ref13","_callee10","_context10","id","Error","makeEdges","_x6","addEdge","_ref14","_callee11","node1","node2","data","_context11","isArray","addDirectedEdge","_x7","_x8","_x9","_ref15","_callee12","node2TargetID","_context12","_x10","_x11","_x12","removeDirectedEdge","_ref16","_callee13","_context13","_x13","_x14","removeEdge","_ref17","_callee14","_context14","_x15","_x16","makeNode","_ref19","_callee15","_ref18","connections","connectionKeys","previousEdges","removeEdges","_context15","concat","undefined","map","item","uuid","index","remove","info","type","read","write","existingEdgeIndex","text","_x17","_ref20","_callee16","_loop","cleanup","_context17","prevEdge","_context16","find","delegateYield","differenceby","_x18","setCurrentDiagram","_ref21","_callee17","_context18","_x19","setName","_ref22","_callee18","name","_context19","_name","_x20","saveUploadedData","_ref24","_callee19","_ref23","_context20","_x21","_ref25","_callee20","diagramKeys","_context21","_deleted","makeNewDiagram","_ref27","_callee21","_ref26","_context22","_x22","setDiagramName","_ref29","_callee22","_ref28","_context23","_x23","deleteNodes","_ref30","_callee23","updatedNodes","updatedEdges","_context24","unset","edgesToRemove","_x24","getTitle","_ref31","_callee24","_context25","deleteDiagram","_ref32","_callee25","_context26","_x25","restoreDiagram","_ref33","_callee26","_context27","_x26","countEdges","_ref34","_callee27","count","_context28","console","log","list","_x27","_Graph","Network","_options","_container","_network","makeData","DataSet","builder","withEdges","withNodes","withOptions","options","inContainer","element","build","VisNetwork","once","fit","animation","duration","easingFunction","network","setData","_Network","useEvent","useEffect","useEventListener","eventName","window","savedHandler","useRef","addEventListener","eventListener","removeEventListener","systemsReducer","state","action","buildGraphData","getLinkColor","getArrowDirection","graphData","shape","shapeProperties","size","face","code","getShape","font","strokeWidth","strokeColor","scaling","min","max","enabled","customScalingFunction","total","scale","Math","shadow","nodeId","from","to","smooth","roundness","hover","highlight","dashes","arrows","SystemsGraph","_useReducer","useReducer","_useReducer2","systems","systemsDispatch","_useState","useState","_useState2","activeNode","setActiveNode","viewPort","lastAdded","selectedNodes","holdingShift","graphContainer","graph","updateGraph","broadcastGraphDataUpdate","deleteSelectedNodes","useCallback","getScale","getViewPosition","displayNodeDetails","results","selected","getSelectedNodes","unselectAll","selectNodes","handleNodeSelect","params","isCluster","matchingNode","handleNodeClick","getNodeAt","pointer","DOM","toConsumableArray","handleNodeDrag","positions","getPositions","handleKeyDown","keyCode","ctrlKey","preventDefault","shiftKey","handleKeyUp","off","on","moveTo","start","Date","systemGraph","autoResize","interaction","hoverConnectedEdges","physics","document","e","Fragment","style","overflow","height","ref","Legend_Legend","downloadFile","diagramName","blob","filename","Blob","dayjs","format","navigator","msSaveOrOpenBlob","msSaveBlob","setAttribute","display","body","appendChild","click","removeChild","handleFile","reader","FileReader","readAsBinaryString","target","files","onloadend","result","handleSearch","toLowerCase","includes","SearchNodes","SearchBox","placeholder","styles","root","width","alignSelf","onChange","debounce","CommandBar","toggleSystemForm","toggleDiagramForm","openDiagramBrowser","querySelector","focus","farItems","iconProps","iconName","onClick","onRender","nearItems","subMenuProps","items","uploadFile","_onClick","CommandBar_CommandBar","boxShadow","canChange","nextPath","nextValue","currentRead","currentWrite","ConnectionReadWrite","Stack","marginRight","marginTop","verticalAlign","tokens","childrenGap","Checkbox","checked","ConnectionContainer","Connection_templateObject","wrapperClassName","mergeStyles","selectors","& .ms-ComboBox","Connection","handleRemove","edit","addNodeForm","nodeFormErrors","setNodeFormErrors","existingSystems","updateNodeForm","selectedTarget","selectedType","selectedRead","selectedWrite","targetError","typeError","path","IconButton","Fabric","ComboBox","allowFreeform","autoComplete","autofill","errorMessage","selectedKey","errors","Dropdown","ConnectionReadWrite_ConnectionReadWrite","SystemType","React","memo","required","prevProps","nextProps","keysUnchanged","errorUnchanged","SystemFormView","addConnection","loading","TextField","onGetErrorMessage","newSystem","String","some","department","url","URL","message","checkURL","multiline","rows","description","conn","cloneElement","renderConnections","ActionButton","makeConnections","system","connectionType","connectedTo","addNodeReducer","addNodeState","formState","set","connectionReducer","Connection_Connection","dispatch","getSystems","sort","b","validate","error","SystemForm","setLoading","_useState3","_useState4","setEdit","_useState5","_useState6","isOpen","setIsOpen","_useState7","_useState8","setExistingSystems","_useState9","_useState10","_useReducer3","_useReducer4","connDispatch","resetForm","resetConnections","_Network$build","getConnectedNodes","connectedNodes","makeFormState","submitSystem","_node","broadcastNodeSave","nodeAdded","dismiss","updateExistingSystems","Panel","headerText","onDismiss","isFooterAtBottom","onRenderFooterContent","horizontal","horizontalAlign","DefaultButton","PrimaryButton","PanelType","medium","SystemFormView_SystemFormView","NodeDetailView","Text","textDecoration","variant","href","rel","CustomPanel","NodeDetail_templateObject","NodeDetail","setNode","editSystem","deselectActiveNode","handleEdit","onRenderHeader","marginLeft","marginBottom","isLightDismiss","customNear","customWidth","NodeDetail_NodeDetailView","cubeMove","keyframes","Loading_templateObject","Spinner","Loading_templateObject2","cubeCSS","css","Loading_templateObject3","CubeOne","Loading_templateObject4","CubeTwo","Loading_templateObject5","Loading","Form","DiagramFormView_templateObject","ButtonGroup","DiagramFormView_templateObject2","Title","DiagramFormView_templateObject3","Close","DiagramFormView_templateObject4","DialogFormView","form","setForm","setErrors","submit","handleNameChange","handleCopyChange","Toggle","inlineLabel","onText","offText","copy","formReducer","removedState","updatedState","DiagramForm","initialForm","openDiagramForm","closeDiagramForm","shouldCopy","Modal","isBlocking","DiagramFormView_DialogFormView","Container","DiagramList_templateObject","DiagramContainer","backgroundColor","DiagramList_templateObject2","DiagramName","toggleEdit","checkForEnter","which","onKeyDown","flex","userSelect","Diagram","handleSelect","graphDataUpdated","broadcastDiagramDeletion","updateGraphDataName","selectDiagram","DiagramList_DiagramName","alignItems","justifyItems","flexDirection","justifySelf","DiagramList","paddingLeft","paddingRight","textAlign","DiagramList_Diagram","defaultProps","ListContainer","DiagramBrowserView_templateObject","DiagramBrowserView","Loading_Loading","DiagramList_DiagramList","diagramReducer","diagramsObject","t0","DiagramBrowser","closeDiagramBrowser","handleDiagramDeletion","DiagramBrowserView_DiagramBrowserView","title","DiagramTitle_templateObject","titleReducer","DiagramTitle","updateTitle","DiagramTitle_Container","Wrapper","sideSize","sidebarSize","Layout_templateObject","HeaderContainer","header","Layout_templateObject2","SidebarContainer","section","Layout_templateObject3","ContentContainer","Layout_templateObject4","FooterContainer","footer","Layout_templateObject5","Layout","children","Header","Sidebar","Content","Footer","Page","App_templateObject","GraphArea","App_templateObject2","App","App_Header","CommandBar_CommandBar_CommandBar","DiagramTitle_DiagramTitle","DiagramForm_DiagramForm","DiagramBrowser_DiagramBrowser","SystemsGraph_SystemsGraph","SystemForm_SystemForm","NodeDetail_NodeDetail","initializeIcons","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.51bd7ddd.chunk.js","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\n\nconst LegendContainer = styled.div`\n  transform: scale(0.3) translate3d(-392px, 450px, 0);\n  position: absolute;\n  bottom: 12px;\n  left: 12px;\n  width: 300px;\n  border: solid 2px #808080;\n  border-radius: 3px;\n  background-color: #e8e3db;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  display: flex;\n  padding: 12px;\n\n  @media only screen and (max-width: 767px) {\n    display: none;\n  }\n\n  transition: transform 300ms ease-in-out;\n\n  &:hover {\n    transform: scale(1) translate3d(0, 0, 0);\n  }\n`\n\nconst LegendIcon = styled.i`\n  color: white;\n  font-size: 60px;\n  text-shadow: 2px 2px 4px #808080;\n  margin: 8px;\n  min-width: 60px;\n`\n\nconst OnCampus = styled(LegendIcon).attrs(props => ({ className: 'ion-md-star' }))``\nconst External = styled(LegendIcon).attrs(props => ({ className: 'ion-md-square' }))``\nconst Cloud = styled(LegendIcon).attrs(props => ({ className: 'ion-md-cloud' }))``\n\nconst NodeContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n`\n\nconst Label = styled.span`\n  color: #363534;\n  font-size: 18px;\n`\n\nconst CircleBox = styled.div`\n  min-width: 60px;\n  width: 60px;\n  margin: 8px;\n`\n\nconst Circle = styled.div`\n  width: 45px;\n  height: 45px;\n  border-radius: 25px;\n  background-color: white;\n  box-shadow: 2px 2px 4px #808080;\n`\n\nconst Node = props => {\n  const Icon = props.icon\n  return (\n    <NodeContainer>\n      <Icon />\n      <Label>{props.label}</Label>\n    </NodeContainer>\n  )\n}\n\nconst CircleNode = props => {\n  return (\n    <NodeContainer>\n      <CircleBox>\n        <Circle />\n      </CircleBox>\n      <Label>{props.label}</Label>\n    </NodeContainer>\n  )\n}\n\nconst EdgeContainer = styled(NodeContainer)`\n  margin-top: 12px;\n  margin-bottom: 24px;\n`\n\nconst EdgeStyle = styled.div`\n  width: 45px;\n  min-width: 45px;\n  border-top: ${({ dashed }) => dashed ? 'dashed' : 'solid'} ${({ color }) => color} 4px;\n`\n\nconst EdgeStyleContainer = styled.div`\n  width: 60px;\n  min-width: 60px;\n  margin: 8px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`\n\nconst Edge = props => {\n  const { color, label, dashed } = props\n  return (\n    <EdgeContainer>\n      <EdgeStyleContainer>\n        <EdgeStyle color={color} dashed={dashed} />\n      </EdgeStyleContainer>\n      <Label >{label}</Label>\n    </EdgeContainer>\n  )\n}\n\nexport const Legend = props => {\n  return (\n    <LegendContainer>\n      <CircleNode icon={OnCampus} label='On Campus System' />\n      <Node icon={External} label='External System' />\n      <Node icon={Cloud} label='Cloud System' />\n      <Edge color='#005481' dashed label='Custom Interface' />\n      <Edge color='#9e6614' label='Built-in Interface' />\n    </LegendContainer>\n  )\n}\n","const _handlers = {}\n\nexport const Subject = {\n  subscribe (event, handler) {\n    if (!_handlers[event]) _handlers[event] = []\n    _handlers[event].push(handler)\n  },\n  unsubscribe (event, handler) {\n    if (!_handlers[event]) return\n    _handlers[event] = _handlers[event].filter(func => func !== handler)\n  },\n  next (event, ...args) {\n    if (!_handlers[event]) return\n    _handlers[event].forEach(handler => {\n      if (typeof handler === 'function') {\n        handler(...args)\n      }\n    })\n  }\n}\n\nObject.freeze(Subject)\n","import get from 'lodash.get'\nimport differenceby from 'lodash.differenceby'\nimport uuid from 'uuid/v4'\nimport unset from 'lodash.unset'\n\nconst shouldFixEdges = true\n\nconst _Graph = () => {\n  const _get = (key, defaultValue) => {\n    const value = localStorage.getItem(key) || defaultValue\n    try {\n      const parsed = JSON.parse(value)\n      return parsed\n    } catch (err) {\n      return value\n    }\n  }\n  const _set = (key, value) => localStorage.setItem(key, JSON.stringify(value))\n\n  const fixEdges = oldEdges => {\n    const edges = { ...oldEdges }\n    const edgeKeys = Object.keys(edges)\n    let didFix = false\n\n    edgeKeys.forEach(key => {\n      const nodeEdges = edges[key]\n      const currentEdgeID = key\n      nodeEdges.forEach(edge => {\n        if (!edge) return\n        if (edge.node === key) return\n        const otherEdges = edges[edge.node]\n        const otherEdgeIndex =\n          otherEdges &&\n          otherEdges.findIndex(edge => edge && edge.node === currentEdgeID)\n        if (otherEdgeIndex >= 0) {\n          otherEdges.splice(otherEdgeIndex, 1)\n          if (!didFix) didFix = true\n        }\n      })\n\n      if (edges.length <= 0) delete nodeEdges[key]\n    })\n\n    return { edges, didFix }\n  }\n\n  const updateNodePosition = async ({ node, x, y }) => {\n    const nodes = await getNodes()\n    if (nodes[node]) {\n      nodes[node].position = {\n        x,\n        y\n      }\n    }\n    return setNodes(nodes)\n  }\n\n  const updateBatchNodePositions = async nodes => {\n    const existingNodes = await getNodes()\n    Object.entries(nodes).forEach(([node, { x, y }]) => {\n      if (existingNodes[node]) {\n        existingNodes[node].position = { x, y }\n      }\n    })\n    return setNodes(existingNodes)\n  }\n\n  const getEdges = async () => {\n    const current = await getCurrentDiagram()\n    if (!current._edges) {\n      const edges = await _get('_edges', {})\n      if (edges) {\n        current._edges = edges\n        await updateDiagrams(current)\n        await localStorage.removeItem('_edges')\n      }\n    }\n\n    const _edges = get(current, `_edges`, {})\n    if (shouldFixEdges) {\n      const { didFix, edges } = fixEdges(_edges)\n      if (didFix) {\n        await setEdges(edges)\n      }\n    }\n    return _edges\n  }\n\n  const getNodesArray = async () => {\n    const nodes = await getNodes()\n    return Object.values(nodes)\n  }\n\n  const getNodes = async () => {\n    const current = await getCurrentDiagram()\n    if (!current._nodes) {\n      const nodes = await _get('_nodes', {})\n      if (nodes) {\n        current._nodes = nodes\n        await updateDiagrams(current)\n        await localStorage.removeItem('_nodes')\n      }\n    }\n\n    return get(current, `_nodes`, {})\n  }\n\n  const getDiagrams = async () => {\n    return _get('_diagrams', {})\n  }\n\n  const updateDiagrams = async diagram => {\n    if (!diagram._id) return\n    const diagrams = await getDiagrams()\n    diagrams[diagram._id] = diagram\n    return _set('_diagrams', diagrams)\n  }\n\n  const setEdges = async edges => {\n    const current = await getCurrentDiagram()\n    current._edges = edges\n    return updateDiagrams(current)\n  }\n\n  const setNodes = async nodes => {\n    const current = await getCurrentDiagram()\n    current._nodes = nodes\n    return updateDiagrams(current)\n  }\n\n  const addNode = async node => {\n    if (!node.id) throw new Error('Nodes must have IDs to be added')\n    const _nodes = await getNodes()\n\n    _nodes[node.id] = node\n\n    await makeEdges(node)\n    await setNodes(_nodes)\n  }\n\n  const addEdge = async (node1, node2, data) => {\n    if (!node1.id || !node2.id) { throw new Error('Nodes must have IDs to add edges') }\n\n    const _edges = await getEdges()\n\n    if (!Array.isArray(_edges[node1.id])) _edges[node1.id] = []\n\n    await addDirectedEdge(node1, node2, data)\n  }\n\n  const addDirectedEdge = async (node1, node2, data) => {\n    if (!node1.id || !node2.id) { throw new Error('Nodes must have IDs to add directed edges') }\n\n    const _edges = await getEdges()\n\n    if (!Array.isArray(_edges[node1.id])) _edges[node1.id] = []\n\n    const node2TargetID = _edges[node1.id].findIndex(\n      edge => edge && edge.node === node2.id\n    )\n\n    if (node2TargetID >= 0) {\n      // Replace edge because it exists already\n      _edges[node1.id][node2TargetID] = { node: node2.id, data }\n    } else {\n      // Add edge, it does not exist\n      _edges[node1.id].push({ node: node2.id, data })\n    }\n\n    await setEdges({ ..._edges })\n  }\n\n  const removeDirectedEdge = async (node1, node2) => {\n    if (!node1.id || !node2.id) { throw new Error('Nodes must have IDs to remove directed eges') }\n\n    const _edges = await getEdges()\n\n    _edges[node1.id] =\n      _edges[node1.id] &&\n      _edges[node1.id].filter(edge => edge && edge.node !== node2.id)\n\n    await setEdges(_edges)\n  }\n\n  const removeEdge = async (node1, node2) => {\n    if (!node1.id || !node2.id) { throw new Error('Nodes must have IDs to remove edges') }\n\n    const _edges = await getEdges()\n\n    _edges[node1.id] =\n      _edges[node1.id] &&\n      _edges[node1.id].filter(edge => edge && edge.node !== node2.id)\n\n    await setEdges(_edges)\n  }\n\n  const makeNode = async ({ id, data, connections }) => {\n    let node = null\n    if (id) {\n      const nodes = await getNodes()\n      const position = get(nodes, `[${id}].position`, {\n        x: undefined,\n        y: undefined\n      })\n      node = {\n        id,\n        edges: [],\n        previousEdges: nodes[id].edges.map(item => ({ ...item })),\n        position,\n        data: {\n          ...nodes[id].data,\n          ...data\n        }\n      }\n    } else {\n      node = {\n        id: uuid(),\n        edges: [],\n        data: {\n          ...(data || {})\n        }\n      }\n    }\n\n    const connectionKeys = Object.keys(connections || {})\n    const previousEdges = get(node, 'previousEdges', [])\n\n    if (connectionKeys.length <= 0 && previousEdges.length > 0) {\n      const edges = await getEdges()\n      delete edges[node.id]\n      const removeEdges = []\n      Object.keys(edges).forEach(key => {\n        edges[key].forEach((edge, index) => {\n          if (edge && edge.node === node.id) {\n            removeEdges.push({ key, index })\n          }\n        })\n      })\n      removeEdges.forEach(remove => {\n        edges[remove.key].splice(remove.index, 1)\n      })\n      await setEdges({ ...edges })\n      return node\n    }\n\n    connectionKeys.forEach(key => {\n      const info = get(connections, `${[key]}.connectedTo`, null)\n      if (!info) { throw new Error('You cannot make a connection without a target') }\n      const type = get(connections, `${[key]}.connectionType`, null)\n      if (!type) throw new Error('You cannot make a connection without a type')\n\n      const read = get(connections, `${[key]}.read`, null)\n      const write = get(connections, `${[key]}.write`, null)\n\n      if (!read && !write) { throw new Error('You must specify a read or a write option') }\n\n      const data = get(connections, `[${key}].data`, {})\n\n      const existingEdgeIndex = node.edges.findIndex(edge => edge.id === key)\n\n      if (existingEdgeIndex >= 0) {\n        node.edges[existingEdgeIndex] = {\n          id: info.key,\n          data: {\n            ...data,\n            read,\n            write,\n            type: {\n              id: type.key,\n              label: type.text\n            }\n          }\n        }\n      } else {\n        node.edges.push({\n          id: info.key,\n          data: {\n            ...data,\n            read,\n            write,\n            type: {\n              id: type.key,\n              label: type.text\n            }\n          }\n        })\n      }\n    })\n    return node\n  }\n\n  const makeEdges = async node => {\n    const edges = get(node, 'edges', [])\n    const previousEdges = get(node, 'previousEdges', [])\n\n    if (edges.length <= 0) return\n\n    for (let i = 0; i < edges.length; i++) {\n      const edge = edges[i]\n\n      const read = get(edge, 'data.read')\n      const write = get(edge, 'data.write')\n\n      const node1 = {\n        id: get(node, 'id')\n      }\n      const node2 = {\n        id: get(edge, 'id')\n      }\n\n      const prevEdge = previousEdges.find(prev => prev && prev.id === edge.id)\n\n      const prev = {\n        read: get(prevEdge, `data.read`, read),\n        write: get(prevEdge, `data.write`, write)\n      }\n\n      if (prev.read && !read) {\n        await removeDirectedEdge(node2, node1)\n      }\n\n      if (prev.write && !write) {\n        await removeDirectedEdge(node1, node2)\n      }\n\n      if (read && write) {\n        await addEdge(node1, node2, get(edge, 'data'))\n      } else if (read) {\n        await addDirectedEdge(node2, node1, get(edge, 'data'))\n      } else if (write) {\n        await addDirectedEdge(node1, node2, get(edge, 'data'))\n      }\n    }\n\n    const cleanup = differenceby(previousEdges, node.edges, 'id')\n\n    if (cleanup.length >= 0) {\n      for (let i = 0; i < cleanup.length; i++) {\n        const edge = cleanup[i]\n\n        const read = get(edge, 'data.read')\n        const write = get(edge, 'data.write')\n\n        const node1 = {\n          id: get(node, 'id')\n        }\n        const node2 = {\n          id: get(edge, 'id')\n        }\n\n        if (read && write) {\n          await removeEdge(node1, node2)\n        } else if (read) {\n          await removeDirectedEdge(node2, node1)\n        } else if (write) {\n          await removeDirectedEdge(node1, node2)\n        }\n      }\n    }\n  }\n\n  const setCurrentDiagram = async id => {\n    return _set('_currentDiagram', id)\n  }\n\n  const setName = async name => {\n    const current = await getCurrentDiagram()\n    current._name = name\n    return updateDiagrams(current)\n  }\n\n  const saveUploadedData = async ({ edges, nodes, id, name }) => {\n    if (id) {\n      await setCurrentDiagram(id)\n    }\n\n    if (name) {\n      await setName(name)\n    }\n    await setNodes(nodes)\n    await setEdges(edges)\n  }\n\n  const getCurrentDiagram = async () => {\n    const diagrams = await getDiagrams()\n    let current = await _get('_currentDiagram', null)\n    const diagramKeys = Object.keys(diagrams).filter(\n      key => !diagrams[key]._deleted\n    )\n    if (!current || get(diagrams, '[current]._deleted')) {\n      if (diagramKeys.length > 0) {\n        current = diagramKeys[0]\n      } else {\n        current = uuid()\n      }\n      _set('_currentDiagram', current)\n    }\n    const diagram = diagrams[current]\n\n    return diagram || { _id: current }\n  }\n\n  const makeNewDiagram = async ({ name, edges, nodes }) => {\n    const _id = uuid()\n    const diagram = {\n      _id,\n      _name: name,\n      _edges: edges,\n      _nodes: nodes\n    }\n\n    await updateDiagrams(diagram)\n    return diagram\n  }\n\n  const setDiagramName = async ({ id, name }) => {\n    if (!id) throw new Error(`Cannot find diagram to update.`)\n\n    const diagrams = await getDiagrams()\n    const diagram = diagrams[id]\n\n    if (!diagram) return\n    diagram._name = name\n\n    await updateDiagrams(diagram)\n  }\n\n  const deleteNodes = async nodes => {\n    if (!Array.isArray(nodes)) return\n    const _edges = await getEdges()\n    const _nodes = await getNodes()\n\n    const updatedNodes = { ..._nodes }\n    const updatedEdges = { ..._edges }\n\n    for (let i = 0; i < nodes.length; i++) {\n      unset(updatedNodes, `[${nodes[i]}]`)\n    }\n\n    const edgeKeys = Object.keys(updatedEdges)\n\n    nodes.forEach(node => {\n      const edgesToRemove = []\n      edgeKeys.forEach(key => {\n        const edges = updatedEdges[key] || []\n        edges.forEach((edge, index) => {\n          if (edge && edge.node === node) {\n            edgesToRemove.push({ index, key })\n          }\n        })\n      })\n      unset(updatedEdges, `[${node}]`)\n      edgesToRemove.forEach(edge => {\n        unset(updatedEdges, `[${edge.key}][${edge.index}]`)\n      })\n    })\n\n    await setEdges(updatedEdges)\n    await setNodes(updatedNodes)\n  }\n\n  const getTitle = async () => {\n    const diagram = await getCurrentDiagram()\n    return diagram._name || ''\n  }\n\n  const deleteDiagram = async id => {\n    let diagrams = await getDiagrams()\n    const diagram = diagrams[id]\n    if (diagram) {\n      diagram._deleted = true\n      await updateDiagrams(diagram)\n      const activeDiagrams = Object.values(diagrams).filter(\n        diagram => !diagram._deleted\n      )\n      if (activeDiagrams.length > 1) {\n        diagrams = await getDiagrams()\n        setCurrentDiagram(Object.keys(diagrams)[0])\n      } else {\n        localStorage.removeItem('_currentDiagram')\n      }\n    }\n  }\n\n  const restoreDiagram = async id => {\n    let diagrams = await getDiagrams()\n    const diagram = diagrams[id]\n    if (diagram) {\n      diagram._deleted = false\n      await updateDiagrams(diagram)\n      const activeDiagrams = Object.values(diagrams).filter(\n        diagram => !diagram._deleted\n      )\n      if (activeDiagrams.length > 1) {\n        diagrams = await getDiagrams()\n        setCurrentDiagram(Object.keys(diagrams)[0])\n      } else {\n        localStorage.removeItem('_currentDiagram')\n      }\n    }\n  }\n\n  const countEdges = async id => {\n    const edges = await getEdges()\n    let count = get(edges, `[${id}].length`)\n    console.log(count)\n    Object.values(edges).forEach(list => {\n      list.forEach(edge => {\n        if (get(edge, 'node') === id) count++\n      })\n    })\n    return count || 1\n  }\n\n  return {\n    getNodes,\n    getEdges,\n    addNode,\n    removeEdge,\n    countEdges,\n    removeDirectedEdge,\n    getDiagrams,\n    updateNodePosition,\n    updateBatchNodePositions,\n    saveUploadedData,\n    getCurrentDiagram,\n    deleteDiagram,\n    restoreDiagram,\n    deleteNodes,\n    makeNewDiagram,\n    getNodesArray,\n    setCurrentDiagram,\n    getTitle,\n    setDiagramName,\n    makeNode\n  }\n}\n\nexport const Graph = _Graph()\n","import { Network as VisNetwork, DataSet } from 'vis-network'\nimport { Graph } from './Graph'\n\nconst _Network = () => {\n  let _nodes = []\n  let _edges = []\n  let _options = {}\n  let _container = null\n  let _network = null\n\n  const inContainer = element => {\n    _container = element\n    return builder\n  }\n\n  const withNodes = nodes => {\n    _nodes = nodes\n    return builder\n  }\n\n  const withEdges = edges => {\n    _edges = edges\n    return builder\n  }\n\n  const withOptions = options => {\n    _options = options\n    return builder\n  }\n\n  const makeData = () => {\n    return {\n      nodes: new DataSet(_nodes),\n      edges: new DataSet(_edges)\n    }\n  }\n\n  const build = () => {\n    if (!_network) {\n      _network = new VisNetwork(_container, makeData(), _options)\n      _network.once('afterDrawing', function () {\n        _network.fit({\n          animation: {\n            duration: 600,\n            easingFunction: 'easeInOutQuad'\n          }\n        })\n      })\n    }\n    return {\n      network: _network,\n      setData: ({ nodes, edges }) => {\n        _nodes = nodes\n        _edges = edges\n        _network.setData(makeData())\n      },\n      updateNodePosition: Graph.updateNodePosition,\n      getNodes: () => _nodes,\n      getEdges: () => _edges\n    }\n  }\n\n  const builder = {\n    withEdges,\n    withNodes,\n    withOptions,\n    inContainer,\n    build\n  }\n\n  return builder\n}\n\nexport const Network = _Network()\n","import { useEffect } from 'react'\nimport { Subject } from '../util/Subject'\n\nexport const useEvent = (event, handler) => {\n  useEffect(() => {\n    if (typeof handler !== 'function') return\n    Subject.subscribe(event, handler)\n    return () => Subject.unsubscribe(event, handler)\n  }, [event, handler])\n\n  return value => Subject.next(event, value)\n}\n","import { useRef, useEffect } from 'react'\n\nexport const useEventListener = (eventName, handler, element = window) => {\n  // Create a ref that stores handler\n  const savedHandler = useRef()\n\n  // Update ref.current value if handler changes.\n  // This allows our effect below to always get latest handler ...\n  // ... without us needing to pass it in effect deps array ...\n  // ... and potentially cause effect to re-run every render.\n  useEffect(() => {\n    savedHandler.current = handler\n  }, [handler])\n\n  useEffect(\n    () => {\n      // Make sure element supports addEventListener\n      // On\n      const isSupported = element && element.addEventListener\n      if (!isSupported) return\n\n      // Create event listener that calls handler function stored in ref\n      const eventListener = event => savedHandler.current(event)\n\n      // Add event listener\n      element.addEventListener(eventName, eventListener)\n\n      // Remove event listener on cleanup\n      return () => {\n        element.removeEventListener(eventName, eventListener)\n      }\n    },\n    [eventName, element] // Re-run if eventName or element changes\n  )\n}\n","import React, { useReducer, useEffect, useCallback, useState, useRef } from 'react'\nimport { Legend } from '../Legend'\nimport { Network, Graph, Subject } from '../../util'\nimport { useEvent, useEventListener } from '../../hooks'\nimport get from 'lodash.get'\n\nconst systemsReducer = (state, action) => {\n  switch (action.type) {\n    case 'update':\n      const nodes = action.nodes\n      const edges = action.edges\n      return buildGraphData(nodes, edges)\n    default:\n      return state\n  }\n}\n\nconst getLinkColor = (type) => {\n  switch (type) {\n    case 'custom':\n      return '#005481'\n    case 'builtin':\n      return '#9e6614'\n    default:\n      return '#A0A0A0'\n  }\n}\n\nconst getShape = (type) => {\n  switch (type) {\n    case 'cloud':\n      // Cloud shape\n      return { shape: 'icon', shapeProperties: { size: 25 }, icon: { face: 'Ionicons', code: '\\uf2c9', color: '#FFF' } }\n    case 'external':\n      return { shape: 'icon', shapeProperties: { size: 25 }, icon: { face: 'Ionicons', code: '\\uf381', color: '#FFF' } }\n    case 'oncampus':\n    default:\n      // Star Shape\n      return { shape: 'dot', size: 15 }\n  }\n}\n\nconst getArrowDirection = (edge) => {\n  const read = get(edge, 'data.read')\n  const write = get(edge, 'data.write')\n\n  if (read && write) return 'middle, from'\n  if (write) return 'middle'\n  if (read) return 'to'\n  return 'to'\n}\n\nconst countEdges = (id, edges) => {\n  let count = get(edges, `[${id}].length`, 0)\n  Object.values(edges).forEach(list => {\n    list.forEach(edge => {\n      if (get(edge, 'node') === id) count++\n    })\n  })\n  return count > 5 ? count : 1\n}\n\nconst buildGraphData = (nodes, edges) => {\n  const graphData = {\n    nodes: [],\n    edges: []\n  }\n\n  const nodeKeys = Object.keys(nodes || {})\n  nodeKeys.forEach(key => {\n    const node = nodes[key]\n\n    graphData.nodes.push({\n      id: node.id,\n      type: node.data.type,\n      ...getShape(node.data.type),\n      label: node.data.name,\n      edges: node.edges,\n      font: {\n        color: '#363534',\n        strokeWidth: 2,\n        strokeColor: '#FFFFFF'\n      },\n      scaling: {\n        min: 15,\n        max: 40,\n        label: {\n          enabled: true\n        },\n        customScalingFunction: (min, max, total, value) => {\n          if (min === max) return 0.5\n          const scale = 1 / (max - min)\n          return Math.max(0, (value - min) * scale)\n        }\n      },\n      value: countEdges(key, edges),\n      shadow: {\n        enabled: true,\n        size: 4,\n        x: 1,\n        y: 1\n      },\n      data: {\n        ...node.data\n      },\n      color: '#FFFFFF',\n      x: get(node, 'position.x'),\n      y: get(node, 'position.y')\n    })\n  })\n\n  const edgeKeys = Object.keys(edges || {})\n  edgeKeys.forEach(nodeId => {\n    const edgeList = edges[nodeId]\n\n    edgeList.forEach(edge => {\n      if (!edge) return\n      graphData.edges.push({\n        from: nodeId,\n        to: edge.node,\n        smooth: {\n          enabled: true,\n          type: 'cubicBezier',\n          roundness: 0.2\n        },\n        color: {\n          color: getLinkColor(get(edge, 'data.type.id')),\n          hover: '#501214',\n          highlight: '#501214'\n        },\n        dashes: get(edge, 'data.type.id') === 'custom',\n        type: get(edge, 'data.type', {}),\n        arrows: getArrowDirection(edge, nodeId)\n      })\n    })\n  })\n\n  return graphData\n}\n\nexport const SystemsGraph = () => {\n  const [systems, systemsDispatch] = useReducer(systemsReducer, { nodes: [], edges: [] })\n  const [activeNode, setActiveNode] = useState()\n  const viewPort = useRef({})\n  const lastAdded = useRef()\n  const selectedNodes = useRef([])\n  const holdingShift = useRef(false)\n\n  const graphContainer = useRef()\n  const graph = useRef()\n\n  const updateGraph = async () => {\n    const nodes = await Graph.getNodes()\n    const edges = await Graph.getEdges()\n    selectedNodes.current = []\n    holdingShift.current = false\n    systemsDispatch({ type: 'update', nodes, edges })\n  }\n\n  const broadcastGraphDataUpdate = useEvent('graph-data-updated', updateGraph)\n\n  const updateSearchResults = (results) => {\n    if (graph.current.network) {\n      if (results.length <= 0) {\n        const selected = graph.current.network.getSelectedNodes()\n        graph.current.network.unselectAll()\n\n        // Were there nodes selected? Zoom back out.\n        if (selected.length > 0) {\n          graph.current.network.fit({\n            animation: {\n              duration: 300,\n              easingFunction: 'easeInOutQuad'\n            }\n          })\n        }\n        return\n      }\n      graph.current.network.selectNodes(results)\n      graph.current.network.fit({\n        nodes: results,\n        animation: {\n          duration: 300,\n          easingFunction: 'easeInOutQuad'\n        }\n      })\n    }\n  }\n\n  const deleteSelectedNodes = useCallback(async () => {\n    if (Array.isArray(selectedNodes.current) && selectedNodes.current.length > 0) {\n      await Graph.deleteNodes(selectedNodes.current)\n      viewPort.current.scale = graph.current.network.getScale()\n      viewPort.current.position = graph.current.network.getViewPosition()\n      selectedNodes.current = []\n      lastAdded.current = null\n      broadcastGraphDataUpdate()\n    }\n  }, [broadcastGraphDataUpdate])\n\n  useEffect(() => {\n    updateGraph()\n  }, [])\n\n  const resetActiveNode = () => setActiveNode(null)\n  const displayNodeDetails = useEvent('display-node-details')\n  useEvent('node-search-result', updateSearchResults)\n\n  const handleNodeSelect = useCallback(params => {\n    const node = get(params, `nodes[0]`, null)\n    if (params.nodes.length > 1 || holdingShift) return\n\n    if (node) {\n      if (!graph.current.network.isCluster(node) && !holdingShift.current) {\n        const matchingNode = systems.nodes.find(({ id }) => id === node)\n        if (matchingNode) {\n          setActiveNode(matchingNode)\n        }\n      }\n    }\n  }, [systems.nodes])\n\n  const handleNodeClick = useCallback(params => {\n    const node = graph.current.network.getNodeAt(params.pointer.DOM)\n    if (node) {\n      if (!graph.current.network.isCluster(node) && !holdingShift.current) {\n        const matchingNode = systems.nodes.find(({ id }) => id === node)\n        if (matchingNode) {\n          setActiveNode(matchingNode)\n        }\n      }\n\n      if (holdingShift.current && params.nodes[0]) {\n        const selected = [...selectedNodes.current, params.nodes[0]]\n        selectedNodes.current = selected\n        graph.current.network.selectNodes(selected)\n      }\n    } else {\n      selectedNodes.current = []\n    }\n  }, [systems.nodes])\n\n  const handleNodeDrag = useCallback(event => {\n    if (event.nodes.length > 0) {\n      const positions = graph.current.network.getPositions(event.nodes)\n      Graph.updateBatchNodePositions(positions)\n    }\n  }, [])\n\n  const handleKeyDown = useCallback(event => {\n    if (event.keyCode === 46 || event.keyCode === 8) { // Delete or Backspace\n      Subject.next('delete-selected-nodes')\n    }\n\n    if (event.ctrlKey && event.keyCode === 70) { // Control + f Shortcut\n      event.preventDefault()\n      Subject.next('focus-search-bar')\n    }\n\n    if (event.shiftKey && !holdingShift.current) {\n      holdingShift.current = true\n    }\n  }, [holdingShift])\n\n  const handleKeyUp = useCallback(event => {\n    if (!event.shiftKey && holdingShift.current) {\n      holdingShift.current = false\n    }\n  }, [holdingShift])\n\n  useEventListener('keydown', handleKeyDown)\n  useEventListener('keyup', handleKeyUp)\n\n  useEffect(() => {\n    if (activeNode) displayNodeDetails(activeNode)\n  }, [activeNode, displayNodeDetails])\n\n  const updateLastAdded = (node) => {\n    lastAdded.current = node\n    viewPort.current.scale = graph.current.network.getScale()\n    viewPort.current.position = graph.current.network.getViewPosition()\n  }\n\n  useEvent('deselect-active-node', resetActiveNode)\n  useEvent('node-added', updateLastAdded)\n  useEvent('delete-selected-nodes', deleteSelectedNodes)\n\n  useEffect(() => {\n    const options = {\n      autoResize: true,\n      interaction: {\n        hover: true,\n        hoverConnectedEdges: true\n      },\n      physics: {\n        enabled: false\n      }\n    }\n\n    if (!graph.current) {\n      const start = new Date()\n      const systemGraph = Network\n        .inContainer(graphContainer.current)\n        .withEdges(systems.edges)\n        .withNodes(systems.nodes)\n        .withOptions(options)\n        .build()\n\n      console.log(`Network Build Time: ${new Date() - start}ms`)\n      graph.current = systemGraph\n\n      graph.current.network.on('selectNode', handleNodeSelect)\n      graph.current.network.on('dragEnd', handleNodeDrag)\n      graph.current.network.on('click', handleNodeClick)\n\n      document.addEventListener('contextmenu', e => e.preventDefault(), false)\n    } else {\n      graph.current.network.off('selectNode')\n      graph.current.network.off('dragEnd')\n      graph.current.network.off('click')\n\n      graph.current.network.on('selectNode', handleNodeSelect)\n      graph.current.network.on('click', handleNodeClick)\n      graph.current.network.on('dragEnd', handleNodeDrag)\n\n      graph.current.setData(systems)\n      if (viewPort.current.position && viewPort.current.scale && !lastAdded.current) {\n        graph.current.network.moveTo({\n          position: viewPort.current.position,\n          scale: viewPort.current.scale\n        })\n        viewPort.current = {}\n      } else if (lastAdded.current) {\n        try {\n          graph.current.network.fit({\n            nodes: [lastAdded.current],\n            animation: {\n              duration: 300,\n              easingFunction: 'easeInOutQuad'\n            }\n          })\n          graph.current.network.selectNodes([lastAdded.current])\n          viewPort.current = {}\n        } catch (err) {\n          lastAdded.current = null\n        }\n      }\n    }\n  }, [systems, handleNodeClick, handleNodeDrag, handleNodeSelect])\n\n  return (\n    <>\n      <div style={{ position: 'relative', overflow: 'hidden', height: '100%' }} ref={graphContainer} id='graph' />\n      <Legend />\n    </>\n  )\n}\n","import dayjs from 'dayjs'\nimport get from 'lodash.get'\nimport uuid from 'uuid/v4'\nimport { Graph } from './Graph'\nimport { Subject } from './Subject'\n\nexport const downloadFile = async () => {\n  const current = await Graph.getCurrentDiagram()\n  const diagramName = get(current, '_name', 'Default Name')\n\n  const edgeKeys = Object.keys(get(current, '_edges', {}))\n  if (current['_edges']) {\n    edgeKeys.forEach(key => {\n      current['_edges'][key] = current['_edges'][key].filter(\n        edge => edge !== null\n      )\n    })\n  }\n\n  const data = JSON.stringify({\n    id: get(current, '_id'),\n    name: get(\n      current,\n      '_name',\n      'Generic and Unnamed Diagram With Exceptionally Long Title'\n    ),\n    nodes: get(current, '_nodes', {}),\n    edges: get(current, '_edges', {})\n  })\n  const element = document.createElement('a')\n  const blob = new Blob([data], { type: 'text/plain' })\n  const filename = `${diagramName} - ${dayjs().format(\n    'YYYY-MM-DD[T]HHmmss'\n  )}.json`\n\n  if (window.navigator.msSaveOrOpenBlob) {\n    window.navigator.msSaveBlob(blob, filename)\n  } else {\n    element.setAttribute('href', `data:text/plain;charset=utf-8,${data}`)\n\n    element.setAttribute('download', filename)\n\n    element.style.display = 'none'\n    document.body.appendChild(element)\n    element.click()\n    document.body.removeChild(element)\n  }\n}\n\nconst handleFile = event => {\n  const reader = new FileReader()\n  reader.readAsBinaryString(event.target.files[0])\n\n  reader.onloadend = async () => {\n    const data = JSON.parse(reader.result)\n\n    const edgeKeys = Object.keys(get(data, 'edges', {}))\n    if (data['edges']) {\n      edgeKeys.forEach(key => {\n        data['edges'][key] = data['edges'][key].filter(edge => edge !== null)\n      })\n    }\n\n    const edges = get(data, 'edges', {})\n    const nodes = get(data, 'nodes', {})\n    const id = get(data, 'id', uuid())\n    const name = get(data, 'name', 'Unnamed System')\n\n    const diagrams = await Graph.getDiagrams()\n\n    if (diagrams[id]) {\n      await Graph.restoreDiagram(diagrams[id]._id)\n    }\n\n    await Graph.saveUploadedData({ edges, nodes, name, id })\n    Subject.next('graph-data-updated')\n  }\n}\n\nexport const uploadFile = () => {\n  const element = document.createElement('input')\n  element.setAttribute('type', 'file')\n  element.setAttribute('accept', '.json')\n\n  element.style.display = 'none'\n  element.addEventListener('change', handleFile)\n  element.click()\n}\n","import React, { useEffect } from 'react'\nimport { useEvent } from '../../hooks'\nimport { CommandBar as OfficeCommandBar } from 'office-ui-fabric-react/lib/CommandBar'\nimport { SearchBox } from 'office-ui-fabric-react/lib/SearchBox'\nimport { downloadFile, uploadFile } from '../../util/FileManager'\nimport { Graph, Subject } from '../../util'\nimport debounce from 'lodash.debounce'\nimport get from 'lodash.get'\n\nconst handleSearch = async (event, value) => {\n  const nodes = await Graph.getNodesArray()\n\n  let results = nodes && nodes.filter(node => {\n    const name = get(node, 'data.name', '').toLowerCase()\n    return name.includes(value.toLowerCase())\n  }).map(({ id }) => id)\n\n  if (!value) {\n    results = []\n  }\n\n  Subject.next('node-search-result', results)\n}\n\nconst SearchNodes = () => {\n  return (\n    <SearchBox\n      id='search-box-nodes'\n      placeholder='Search'\n      className='searchBox'\n      styles={{\n        root: {\n          width: '250px',\n          alignSelf: 'center'\n        }\n      }}\n      onChange={debounce(handleSearch, 500)}\n    />\n  )\n}\n\nexport const CommandBar = props => {\n  const toggleSystemForm = useEvent('toggle-system-form')\n  const toggleDiagramForm = useEvent('toggle-diagram-form')\n  const openDiagramBrowser = useEvent('open-diagram-browser')\n\n  useEffect(() => {\n    const focusSearch = () => {\n      const searchBox = document.querySelector('#search-box-nodes')\n      searchBox.focus()\n    }\n\n    Subject.subscribe('focus-search-bar', focusSearch)\n  }, [])\n\n  const farItems = [\n    {\n      key: 'open',\n      name: 'Open Diagram',\n      iconProps: {\n        iconName: 'OpenFile'\n      },\n      onClick: openDiagramBrowser\n    },\n    {\n      key: 'search',\n      onRender: SearchNodes\n    }\n  ]\n\n  const nearItems = [\n    {\n      key: 'add',\n      name: 'Add',\n      iconProps: {\n        iconName: 'Add'\n      },\n      subMenuProps: {\n        items: [\n          {\n            key: 'system',\n            name: 'System',\n            onClick: toggleSystemForm,\n            iconProps: {\n              iconName: 'GitGraph'\n            }\n          },\n          {\n            key: 'diagram',\n            name: 'Diagram',\n            onClick: toggleDiagramForm,\n            iconProps: {\n              iconName: 'VisioDiagram'\n            }\n          }\n        ]\n      }\n    },\n    {\n      key: 'upload',\n      name: 'Upload',\n      iconProps: {\n        iconName: 'Upload'\n      },\n      onClick: () => {\n        uploadFile()\n      }\n    },\n    {\n      key: 'download',\n      name: 'Download',\n      iconProps: {\n        iconName: 'Download'\n      },\n      onClick: async () => {\n        downloadFile()\n      }\n    }\n  ]\n\n  return (\n    <div>\n      <OfficeCommandBar\n        styles={{\n          root: {\n            boxShadow: '0 2px 2px #30303030'\n          }\n        }}\n        items={nearItems}\n        farItems={farItems}\n      />\n    </div>\n  )\n}\n","import React from 'react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox'\n\nconst canChange = (nextPath, nextValue) => (currentRead, currentWrite) => {\n  if (nextPath === 'read') {\n    return nextValue || currentWrite || false\n  }\n\n  if (nextPath === 'write') {\n    return nextValue || currentRead || false\n  }\n  return false\n}\n\nexport const ConnectionReadWrite = props => {\n  const { read, write, onChange } = props\n\n  return (\n    <Stack style={{ marginRight: 8, marginTop: 8 }} verticalAlign='space-between' tokens={{ childrenGap: 4 }}>\n      <Checkbox checked={!!read} onChange={(event, value) => {\n        if (canChange('read', value)(read, write)) {\n          onChange('read', value)\n        }\n      }} label='Receives Data' />\n      <Checkbox checked={!!write} onChange={(event, value) => {\n        if (canChange('write', value)(read, write)) {\n          onChange('write', value)\n        }\n      }} label='Sends Data' />\n    </Stack>\n  )\n}\n","import React, { useEffect } from 'react'\nimport styled from 'styled-components'\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown'\nimport { Fabric } from 'office-ui-fabric-react/lib/Fabric'\nimport { mergeStyles } from 'office-ui-fabric-react/lib/index'\nimport { ComboBox } from 'office-ui-fabric-react/lib/ComboBox'\nimport { ConnectionReadWrite } from './ConnectionReadWrite'\nimport get from 'lodash.get'\nimport { IconButton } from 'office-ui-fabric-react'\n\nconst ConnectionContainer = styled.div`\n  display: flex;\n  align-items: flex-start;\n  flex-direction: column;\n  justify-content: flex-start;\n  padding: 8px;\n  margin-top: 12px;\n  border: 1px solid rgb(138, 136, 134);\n  box-sizing: border-box;\n  border-radius: 1px;\n\n  & > .ms-Dropdown-container {\n    flex: 1;\n    width: 100%;\n    margin-right: 4px;\n  }\n\n  & > .ms-Button--icon {\n    align-self: flex-end;\n  }\n`\n\nconst wrapperClassName = mergeStyles({\n  selectors: {\n    '& .ms-ComboBox': { width: '100%' }\n  }\n})\n\nexport const Connection = props => {\n  const { handleRemove, id, edit, addNodeForm, nodeFormErrors, setNodeFormErrors, existingSystems, updateNodeForm } = props\n  const selectedTarget = get(addNodeForm, `connections[${id}].connectedTo.key`, null)\n  const selectedType = get(addNodeForm, `connections[${id}].connectionType.key`, null)\n\n  const selectedRead = get(addNodeForm, `connections[${id}].read`, true)\n  const selectedWrite = get(addNodeForm, `connections[${id}].write`, false)\n\n  const targetError = get(nodeFormErrors, `[${id}].target`)\n  const typeError = get(nodeFormErrors, `[${id}].type`)\n\n  useEffect(() => {\n    if (!edit) {\n      updateNodeForm({\n        path: `connections[${id}].read`,\n        value: true\n      })\n    }\n  }, [updateNodeForm, id, edit])\n\n  return (\n    <ConnectionContainer>\n      <IconButton\n        iconProps={{ iconName: 'ChromeClose' }}\n        onClick={() => {\n          const connection = get(addNodeForm, `connections[${id}]`, null)\n          if (connection) {\n            updateNodeForm({\n              path: `connections[${id}]`,\n              type: 'remove'\n            })\n          }\n          handleRemove()\n        }}\n      />\n      <Fabric style={{ alignSelf: 'stretch' }} className={wrapperClassName}>\n        <ComboBox\n          allowFreeform\n          autoComplete='on'\n          autofill\n          label='Connected To'\n          placeholder={`What does this system connect to?`}\n          options={existingSystems}\n          errorMessage={targetError}\n          selectedKey={selectedTarget}\n          onChange={(event, value) => {\n            updateNodeForm({\n              path: `connections[${id}].connectedTo`,\n              value: { key: value.key, text: value.text }\n            })\n            if (`${id}` in nodeFormErrors) {\n              const errors = {\n                ...nodeFormErrors\n              }\n              delete errors[id]\n              setNodeFormErrors(errors)\n            }\n          }}\n        />\n      </Fabric>\n      <Dropdown\n        label='Interface'\n        options={[\n          { key: 'builtin', text: 'Built In' },\n          { key: 'custom', text: 'Custom' }\n        ]}\n        placeholder='How does this system connect?'\n        selectedKey={selectedType}\n        errorMessage={typeError}\n        onChange={(event, value) => {\n          updateNodeForm({\n            path: `connections[${id}].connectionType`,\n            value: { key: value.key, text: value.text, color: value.color }\n          })\n          if (`${id}` in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors[id]\n            setNodeFormErrors(errors)\n          }\n        }}\n      />\n      <ConnectionReadWrite\n        read={selectedRead}\n        write={selectedWrite}\n        onChange={(path, value) => {\n          updateNodeForm({\n            path: `connections[${id}].${path}`,\n            value\n          })\n        }}\n      />\n    </ConnectionContainer>\n  )\n}\n","import React from 'react'\nimport { Dropdown } from 'office-ui-fabric-react/lib/Dropdown'\n\nconst areEqual = (prevProps, nextProps) => {\n  const keysUnchanged = prevProps.selectedKey === nextProps.selectedKey\n  const errorUnchanged = prevProps.errorMessage === nextProps.errorMessage\n  return keysUnchanged && errorUnchanged\n}\n\nexport const SystemType = React.memo(props => {\n  const { selectedKey, onChange, required, errorMessage } = props\n\n  return (\n    <Dropdown\n      required={required}\n      label='System Type'\n      options={[\n        { key: 'oncampus', text: 'On Campus' },\n        { key: 'cloud', text: 'Cloud' },\n        { key: 'external', text: 'External' }\n      ]}\n      errorMessage={errorMessage}\n      placeholder='Where does this system live?'\n      selectedKey={selectedKey}\n      onChange={onChange}\n    />\n  )\n}, areEqual)\n","import React from 'react'\nimport { TextField } from 'office-ui-fabric-react/lib/TextField'\nimport { ActionButton } from 'office-ui-fabric-react'\nimport { SystemType } from './SystemType'\n\nconst renderConnections = ({ connections, existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors }) => {\n  return connections.map(conn => React.cloneElement(conn, { existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors }))\n}\n\nconst checkURL = url => {\n  if (!url) return\n  try {\n    const checkedURL = new URL(url)\n    if (checkedURL) return ''\n  } catch (err) {\n    return err.message\n  }\n}\n\nexport const SystemFormView = props => {\n  const {\n    nodeFormErrors,\n    existingSystems,\n    setNodeFormErrors,\n    addNodeForm,\n    updateNodeForm,\n    connections,\n    addConnection,\n    edit,\n    loading\n  } = props\n  if (loading) return null\n  return (\n    <>\n      <TextField\n        label='Name'\n        placeholder='Choose a name'\n        errorMessage={nodeFormErrors.name}\n        required\n        onGetErrorMessage={(value => {\n          const newSystem = String(value).toLowerCase()\n          const nameExists = existingSystems.some(({ text }) => String(text).toLowerCase() === newSystem)\n          if (nameExists && !edit) {\n            setNodeFormErrors({\n              ...nodeFormErrors,\n              name: `The ${value} system already exists`\n            })\n          } else {\n            if (nodeFormErrors.name) {\n              const errors = {\n                ...nodeFormErrors\n              }\n              delete errors.name\n              setNodeFormErrors(errors)\n            }\n          }\n        })}\n        onChange={(event, value) => updateNodeForm({ path: 'name', value })}\n        value={addNodeForm.name || ''}\n      />\n      <SystemType\n        required\n        errorMessage={nodeFormErrors.type}\n        selectedKey={addNodeForm.type || null}\n        onChange={(event, value) => {\n          updateNodeForm({ path: 'type', value: value.key })\n          if ('type' in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors.type\n            setNodeFormErrors(errors)\n          }\n        }}\n      />\n      <TextField\n        label='Department'\n        placeholder='Was this built for another department?'\n        onChange={(event, value) => updateNodeForm({ path: 'department', value })}\n        value={addNodeForm.department || ''}\n      />\n      <TextField\n        label='URL'\n        placeholder='Is there a url to access this system?'\n        errorMessage={nodeFormErrors.url}\n        onChange={(event, value) => {\n          updateNodeForm({ path: 'url', value })\n          if ('url' in nodeFormErrors) {\n            const errors = {\n              ...nodeFormErrors\n            }\n            delete errors.url\n            setNodeFormErrors(errors)\n          }\n        }}\n        onGetErrorMessage={value => {\n          if (!value) return\n          return checkURL(value)\n        }}\n        value={addNodeForm.url || ''}\n      />\n      <TextField\n        label='Description'\n        placeholder='Enter some information others may want to know about this system'\n        multiline\n        rows={4}\n        onChange={(event, value) => updateNodeForm({ path: 'description', value })}\n        value={addNodeForm.description || ''}\n      />\n      {renderConnections({ connections, existingSystems, addNodeForm, updateNodeForm, setNodeFormErrors, nodeFormErrors })}\n      <ActionButton\n        onClick={addConnection}\n        iconProps={{ iconName: 'Add' }}\n      >\n        Add Connection\n      </ActionButton>\n    </>\n  )\n}\n","import React, { useState, useEffect, useReducer } from 'react'\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel'\nimport { Graph } from '../../util'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { PrimaryButton, DefaultButton } from 'office-ui-fabric-react'\nimport { useEvent } from '../../hooks'\nimport get from 'lodash.get'\nimport uuid from 'uuid/v4'\nimport set from 'lodash.set'\nimport unset from 'lodash.unset'\nimport { Connection } from './Connection'\nimport { Network } from '../../util/Network'\nimport { SystemFormView } from './SystemFormView'\n\nconst makeConnections = (system, nodes) => {\n  const connections = {}\n  system.edges.forEach(edge => {\n    connections[edge.id] = {\n      read: edge.data.read,\n      write: edge.data.write,\n      connectionType: {\n        key: edge.data.type.id,\n        text: edge.data.type.label\n      },\n      connectedTo: {\n        key: edge.id,\n        text: get(nodes.filter(node => node.id === edge.id), '[0].data.name', '')\n      }\n    }\n  })\n  return connections\n}\n\nconst checkURL = url => {\n  if (!url) return\n  try {\n    const checkedURL = new URL(url)\n    if (checkedURL) return null\n  } catch (err) {\n    return err.message\n  }\n}\n\nconst makeFormState = system => {\n  const { network, getNodes } = Network.build()\n  const nodes = network.getConnectedNodes(system.id)\n\n  const connectedNodes = getNodes().filter(({ id }) => nodes.includes(id))\n\n  const formState = {\n    name: get(system, 'data.name'),\n    id: get(system, 'id'),\n    type: get(system, 'data.type'),\n    department: get(system, 'data.department'),\n    url: get(system, 'data.url'),\n    description: get(system, 'data.description'),\n    connections: makeConnections(system, connectedNodes)\n  }\n  return formState\n}\n\nconst addNodeReducer = (state, action) => {\n  if (action.path === '') return {}\n  const addNodeState = { ...state }\n  switch (action.type) {\n    case 'remove':\n      unset(addNodeState, action.path)\n      return addNodeState\n    case 'edit':\n      return { ...action.formState }\n    default:\n      set(addNodeState, action.path, action.value)\n      return addNodeState\n  }\n}\n\nconst connectionReducer = (connections, action) => {\n  switch (action.type) {\n    case 'add':\n      const id = uuid()\n      return [\n        ...connections,\n        <Connection\n          key={id}\n          id={id}\n          handleRemove={() => action.dispatch({ type: 'remove', id })}\n        />\n      ]\n    case 'remove':\n      return connections.filter(({ key }) => key !== action.id)\n    case 'reset':\n      return []\n    case 'edit':\n      const connKeys = Object.keys(action.connections)\n      return connKeys.map(key => {\n        const id = key\n        const dispatch = get(action, 'dispatch', null)\n\n        if (!dispatch || !id) return null\n\n        return (\n          <Connection\n            edit\n            key={id}\n            id={id}\n            handleRemove={() => dispatch({ type: 'remove', id })}\n          />\n        )\n      }).filter(item => item)\n    default:\n      return connections\n  }\n}\n\nconst getSystems = async () => {\n  const nodes = await Graph.getNodesArray()\n  return nodes.map(node => ({ key: node.id, text: node.data.name })).sort((a, b) => {\n    if (a.text < b.text) return -1\n    if (a.text > b.text) return 1\n    return 0\n  })\n}\n\nconst validate = (addNodeForm, nodeFormErrors) => {\n  let errors = {}\n  if (nodeFormErrors) {\n    errors = {\n      ...nodeFormErrors\n    }\n  }\n\n  if (!addNodeForm.type) {\n    errors.type = 'A system type must be selected'\n  }\n\n  if (!addNodeForm.name) {\n    errors.name = 'A system name is required'\n  }\n\n  if (addNodeForm.url) {\n    const error = checkURL(addNodeForm.url)\n    if (error) errors.url = error\n  }\n\n  if (addNodeForm.connections) {\n    const keys = Object.keys(addNodeForm.connections || {})\n    keys.forEach(key => {\n      const target = get(addNodeForm, `connections[${key}].connectedTo.key`, null)\n      const type = get(addNodeForm, `connections[${key}].connectionType.key`, null)\n\n      if (!type) set(errors, `[${key}].type`, 'The connection must have a type selected')\n      if (!target) set(errors, `[${key}].target`, 'You must select another system to connect to')\n    })\n  }\n\n  return errors\n}\n\nexport const SystemForm = (props) => {\n  const [loading, setLoading] = useState(true)\n  const [edit, setEdit] = useState(false)\n  const [isOpen, setIsOpen] = useState(false)\n  const [addNodeForm, updateNodeForm] = useReducer(addNodeReducer, {})\n  const [existingSystems, setExistingSystems] = useState()\n  const [nodeFormErrors, setNodeFormErrors] = useState({})\n  const [connections, connDispatch] = useReducer(connectionReducer, [])\n\n  const toggle = () => setIsOpen(!isOpen)\n  const resetForm = () => updateNodeForm({ path: '', value: {} })\n  const resetConnections = () => connDispatch({ type: 'reset' })\n\n  const handleEditSystem = (system) => {\n    const formState = makeFormState(system)\n    connDispatch({\n      type: 'edit',\n      connections: formState.connections || {},\n      dispatch: connDispatch\n    })\n    updateNodeForm({ type: 'edit', formState })\n    setEdit(true)\n    setIsOpen(true)\n  }\n\n  useEvent('edit-system-panel', handleEditSystem)\n\n  const addConnection = () => {\n    connDispatch({\n      type: 'add',\n      dispatch: connDispatch,\n      existingSystems,\n      addNodeForm,\n      updateNodeForm\n    })\n  }\n\n  const submitSystem = async () => {\n    const errors = validate(addNodeForm, nodeFormErrors)\n    if (Object.keys(errors).length > 0) {\n      setNodeFormErrors({\n        ...nodeFormErrors,\n        ...errors\n      })\n      return\n    }\n\n    const connections = get(addNodeForm, 'connections', {})\n    const data = {\n      description: get(addNodeForm, 'description', ''),\n      name: get(addNodeForm, 'name', ''),\n      type: get(addNodeForm, 'type', ''),\n      url: get(addNodeForm, 'url', ''),\n      department: get(addNodeForm, 'department', '')\n    }\n\n    let id = null\n    if (edit) {\n      const node = await Graph.makeNode({ id: addNodeForm.id, connections, data })\n      id = addNodeForm.id\n      await Graph.addNode(node)\n    } else {\n      const node = await Graph.makeNode({ connections, data })\n      id = node.id\n      await Graph.addNode(node)\n    }\n\n    broadcastNodeSave()\n    nodeAdded(id)\n    resetConnections()\n    resetForm()\n    if (edit) {\n      dismiss()\n    }\n  }\n\n  useEvent('toggle-system-form', toggle)\n  const dismiss = () => {\n    resetForm()\n    resetConnections()\n    setIsOpen(false)\n    setEdit(false)\n  }\n\n  const updateExistingSystems = async () => {\n    const systems = await getSystems()\n    setLoading(false)\n    setExistingSystems(systems)\n  }\n\n  useEffect(() => {\n    updateExistingSystems()\n  }, [])\n\n  const broadcastNodeSave = useEvent('graph-data-updated', updateExistingSystems)\n  const nodeAdded = useEvent('node-added')\n\n  return (\n    <Panel\n      headerText={`${edit ? 'Edit' : 'Add'} System`}\n      isOpen={isOpen}\n      onDismiss={dismiss}\n      isFooterAtBottom\n      onRenderFooterContent={() => (\n        <Stack horizontal horizontalAlign='space-between' tokens={{ childrenGap: 12 }}>\n          <DefaultButton text='Cancel' onClick={dismiss} />\n          <PrimaryButton text='Save System' onClick={submitSystem} />\n        </Stack>\n      )}\n      type={PanelType.medium}\n    >\n      <SystemFormView\n        loading={loading}\n        edit={edit}\n        existingSystems={existingSystems}\n        nodeFormErrors={nodeFormErrors}\n        setNodeFormErrors={setNodeFormErrors}\n        addNodeForm={addNodeForm}\n        updateNodeForm={updateNodeForm}\n        connections={connections}\n        addConnection={addConnection}\n      />\n    </Panel>\n  )\n}\n","import React from 'react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\n\nconst NodeDetailView = props => {\n  const { description, department, url } = props\n  return (\n    <Stack tokens={{ childrenGap: 8 }}>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>URL</Text>\n        <a href={url} target='_blank' rel='noopener noreferrer'>{url}</a>\n      </Stack>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>Department</Text>\n        <Text>{department}</Text>\n      </Stack>\n      <Stack tokens={{ childrenGap: 4 }}>\n        <Text style={{ textDecoration: 'underline' }} variant='mediumPlus'>Description</Text>\n        <Text>{description}</Text>\n      </Stack>\n    </Stack>\n  )\n}\n\nexport default NodeDetailView\n","import React, { useState } from 'react'\nimport { Panel, PanelType } from 'office-ui-fabric-react/lib/Panel'\nimport { IconButton } from 'office-ui-fabric-react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\nimport styled from 'styled-components'\nimport get from 'lodash.get'\nimport { useEvent } from '../../hooks'\nimport NodeDetailView from './NodeDetailView'\n\nconst CustomPanel = styled(Panel)`\n  & > .ms-Panel-main {\n    transition: width 300ms ease-in-out;\n  }\n`\n\nexport const NodeDetail = props => {\n  const [isOpen, setIsOpen] = useState(false)\n  const [node, setNode] = useState(null)\n  const displayNode = (node) => {\n    setNode(node)\n    setIsOpen(true)\n  }\n  const closePanel = () => setIsOpen(false)\n\n  useEvent('display-node-details', displayNode)\n  const editSystem = useEvent('edit-system-panel')\n  const deselectActiveNode = useEvent('deselect-active-node')\n  const name = get(node, 'data.name', 'Very Unnamed System')\n  const description = get(node, 'data.description', 'No description has been entered.')\n  const department = get(node, 'data.department', 'No department has been entered.')\n  const url = get(node, 'data.url', `${name} has no url`)\n\n  const handleEdit = () => {\n    editSystem(node)\n    setIsOpen(false)\n    deselectActiveNode()\n  }\n\n  return (\n    <CustomPanel\n      isOpen={isOpen}\n      onDismiss={() => {\n        deselectActiveNode()\n        closePanel()\n      }}\n      onRenderHeader={(props) => {\n        return (\n          <Stack horizontal tokens={{ childrenGap: 12 }}>\n            <Text variant='xLarge' style={{ marginLeft: 16, marginBottom: 12 }}>{props.headerText}</Text>\n            <IconButton\n              iconProps={{\n                iconName: 'Edit'\n              }}\n              onClick={handleEdit}\n            />\n          </Stack>\n        )\n      }}\n      isLightDismiss\n      type={PanelType.customNear}\n      customWidth={400}\n      headerText={name}\n    >\n      <NodeDetailView\n        department={department}\n        description={description}\n        url={url}\n      />\n    </CustomPanel>\n  )\n}\n","import React from 'react'\nimport styled, { keyframes, css } from 'styled-components'\n\nconst cubeMove = keyframes`\n    25% { \n      transform: translateX(42px) rotate(-90deg) scale(0.5);\n      -webkit-transform: translateX(42px) rotate(-90deg) scale(0.5);\n    } 50% { \n      transform: translateX(42px) translateY(42px) rotate(-179deg);\n      -webkit-transform: translateX(42px) translateY(42px) rotate(-179deg);\n    } 50.1% { \n      transform: translateX(42px) translateY(42px) rotate(-180deg);\n      -webkit-transform: translateX(42px) translateY(42px) rotate(-180deg);\n    } 75% { \n      transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n      -webkit-transform: translateX(0px) translateY(42px) rotate(-270deg) scale(0.5);\n    } 100% { \n      transform: rotate(-360deg);\n      -webkit-transform: rotate(-360deg);\n    }\n`\n\nconst Spinner = styled.div`\n  margin: 100px auto;\n  width: 40px;\n  height: 40px;\n  align-self: center;\n  justify-self: center;\n  position: relative;\n`\n\nconst cubeCSS = css`\n  background-color: #501214;\n  width: 15px;\n  height: 15px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  \n  -webkit-animation: ${cubeMove} 1.8s infinite ease-in-out;\n  animation: ${cubeMove} 1.8s infinite ease-in-out;\n`\n\nconst CubeOne = styled.div`\n  ${cubeCSS}\n`\nconst CubeTwo = styled.div`\n  ${cubeCSS}\n  animation-delay: -0.9s;\n`\n\nexport const Loading = props => {\n  return (\n    <Spinner>\n      <CubeOne />\n      <CubeTwo />\n    </Spinner>\n  )\n}\n","import React, { useCallback } from 'react'\nimport { Stack } from 'office-ui-fabric-react/lib/Stack'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\nimport { IconButton, DefaultButton, PrimaryButton, Toggle } from 'office-ui-fabric-react'\nimport { TextField } from 'office-ui-fabric-react/lib/TextField'\nimport styled from 'styled-components'\n\nconst Form = styled(Stack)`\n  padding: 12px;\n`\n\nconst ButtonGroup = styled(Stack)`\n  padding-top: 24px;\n`\n\nconst Title = styled(Text)`\n  padding: 12px;\n  margin-right: 40px;\n`\n\nconst Close = styled(IconButton).attrs(() => ({ iconProps: { iconName: 'ChromeClose' } }))``\n\nexport const DialogFormView = props => {\n  const { dismiss, form, setForm, setErrors, submit, errors } = props\n\n  const handleNameChange = useCallback((event, value) => {\n    if (value) setErrors({ type: 'remove', path: 'name' })\n    setForm({ type: 'update', path: 'name', value })\n  }, [setForm, setErrors])\n\n  const handleCopyChange = useCallback((event, value) => {\n    setForm({ type: 'update', path: 'copy', value })\n  }, [setForm])\n\n  return (\n    <Form tokens={{ childrenGap: 12 }}>\n      <Stack horizontal>\n        <Title variant='xxLarge'>Add New Diagram</Title>\n        <Close onClick={dismiss} />\n      </Stack>\n      <TextField\n        label='Name'\n        placeholder={`Enter a name for your diagram`}\n        errorMessage={errors.name || ''}\n        value={form.name || ''}\n        onChange={handleNameChange}\n      />\n      <Toggle\n        inlineLabel\n        onText='On'\n        offText='Off'\n        label='Copy Current Diagram'\n        checked={form.copy || false}\n        onChange={handleCopyChange}\n      />\n      <ButtonGroup horizontal horizontalAlign='space-between'>\n        <DefaultButton text='Cancel' onClick={dismiss} />\n        <PrimaryButton text='Submit' onClick={submit} />\n      </ButtonGroup>\n    </Form>\n  )\n}\n","import React, { useReducer, useCallback, useState } from 'react'\nimport { useEvent } from '../../hooks'\nimport { Graph } from '../../util'\nimport { Modal } from 'office-ui-fabric-react/lib/Modal'\nimport { DialogFormView } from './DiagramFormView'\nimport set from 'lodash.set'\nimport unset from 'lodash.unset'\n\nconst formReducer = (state, action) => {\n  if (action.path === '') return {}\n  switch (action.type) {\n    case 'remove':\n      const removedState = { ...state }\n      if (action.path) unset(removedState, action.path)\n      return removedState\n    case 'update':\n      const updatedState = { ...state }\n      return set(updatedState, action.path, action.value)\n    default:\n      return state\n  }\n}\n\nconst validate = form => {\n  const errors = {}\n  if (!form.name) errors.name = 'Diagrams must have a name, c\\'mon it\\'s one text field'\n  return errors\n}\n\nexport const DiagramForm = props => {\n  const { initialForm } = props\n  const [isOpen, setIsOpen] = useState(false)\n  const [form, setForm] = useReducer(formReducer, initialForm || {})\n  const [errors, setErrors] = useReducer(formReducer, {})\n\n  const openDiagramForm = useCallback(() => {\n    setIsOpen(true)\n  }, [setIsOpen])\n\n  const closeDiagramForm = useCallback(() => {\n    setIsOpen(false)\n  }, [setIsOpen])\n\n  useEvent('toggle-diagram-form', openDiagramForm)\n  const broadcastGraphDataUpdate = useEvent('graph-data-updated')\n\n  const submit = useCallback(async () => {\n    const errors = validate(form)\n    if (errors.name) {\n      setErrors({ type: 'update', path: 'name', value: errors.name })\n    } else {\n      const shouldCopy = form.copy\n      const diagram = {\n        name: form.name\n      }\n      if (shouldCopy) {\n        diagram.nodes = await Graph.getNodes()\n        diagram.edges = await Graph.getEdges()\n      }\n\n      const { _id } = await Graph.makeNewDiagram(diagram)\n      closeDiagramForm()\n      await Graph.setCurrentDiagram(_id)\n      broadcastGraphDataUpdate()\n    }\n  }, [setErrors, form, closeDiagramForm, broadcastGraphDataUpdate])\n\n  return (\n    <Modal\n      isBlocking={false}\n      onDismiss={closeDiagramForm}\n      isOpen={isOpen}\n    >\n      <DialogFormView\n        form={form}\n        setForm={setForm}\n        setErrors={setErrors}\n        errors={errors}\n        submit={submit}\n        dismiss={closeDiagramForm}\n      />\n    </Modal>\n  )\n}\n","import React, { useEffect, useState, useCallback } from 'react'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\nimport { TextField } from 'office-ui-fabric-react/lib/TextField'\nimport { ActionButton } from 'office-ui-fabric-react'\nimport { useEvent } from '../../hooks'\nimport { Graph } from '../../util'\nimport styled from 'styled-components'\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n`\n\nconst DiagramContainer = styled.div.attrs(props => ({\n  backgroundColor: props.edit ? 'transparent' : 'rgb(237, 235, 233)'\n}))`\n  display: flex;\n  flex: 1;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px;\n  cursor: default;\n\n  &:hover {\n    background-color: ${({ backgroundColor }) => backgroundColor}\n  }\n\n  transition: background-color 200ms ease-in-out;\n`\n\nconst DiagramName = ({ edit, name, onChange, toggleEdit }) => {\n  const checkForEnter = useCallback((event) => {\n    if (event.which === 13) { // Enter key pressed\n      toggleEdit()\n    }\n  }, [toggleEdit])\n\n  if (!edit) return <Text styles={{ root: { userSelect: 'none' } }} variant='large'>{name || 'No Name Set'}</Text>\n  return (\n    <TextField\n      onKeyDown={checkForEnter}\n      styles={{ root: { flex: 1 } }}\n      placeholder='Enter a name for this system'\n      value={name}\n      onChange={onChange}\n    />\n  )\n}\n\nconst Diagram = ({ name, id, handleSelect }) => {\n  const [edit, setEdit] = useState(false)\n  const [diagramName, setDiagramName] = useState(name)\n  const graphDataUpdated = useEvent('graph-data-updated')\n  const broadcastDiagramDeletion = useEvent('diagram-deleted')\n\n  const updateGraphDataName = useCallback(async () => {\n    await Graph.setDiagramName({ id, name: diagramName })\n    graphDataUpdated()\n  }, [graphDataUpdated, diagramName, id])\n\n  useEffect(() => {\n    updateGraphDataName()\n  }, [updateGraphDataName])\n\n  const toggleEdit = useCallback(() => {\n    setEdit(edit => !edit)\n  }, [setEdit])\n\n  const selectDiagram = useCallback(async (event) => {\n    await Graph.setCurrentDiagram(id)\n    graphDataUpdated()\n  }, [id, graphDataUpdated])\n\n  const deleteDiagram = useCallback(async (event) => {\n    const diagram = await Graph.getCurrentDiagram()\n    await Graph.deleteDiagram(diagram._id)\n    graphDataUpdated()\n    broadcastDiagramDeletion()\n  }, [graphDataUpdated, broadcastDiagramDeletion])\n\n  const handleNameChange = useCallback((event, value) => {\n    setDiagramName(value)\n  }, [setDiagramName])\n\n  return (\n    <DiagramContainer onClick={!edit ? selectDiagram : () => null} edit={edit}>\n      <DiagramName toggleEdit={toggleEdit} edit={edit} name={diagramName} onChange={handleNameChange} />\n      <div style={{display: 'flex', alignItems: 'center', justifyItems: 'flex-end', flexDirection: 'row'}}>\n        <ActionButton styles={{ root: { justifySelf: 'flex-end' } }} text='Edit' iconProps={{ iconName: 'Edit' }} onClick={toggleEdit} />\n        <ActionButton styles={{ root: { justifySelf: 'flex-end' } }} text='Delete' iconProps={{ iconName: 'Delete' }} onClick={deleteDiagram} /> \n      </div>\n    </DiagramContainer>\n  )\n}\n\nexport const DiagramList = props => {\n  const { diagrams } = props\n  if (diagrams.length <= 0) {\n    return (\n      <Container>\n        <Text styles={{ root: { flex: 1, paddingLeft: 8, paddingRight: 8, textAlign: 'center' } }} variant='xxLargePlus'>No Diagrams Are Saved</Text>\n      </Container>\n    )\n  }\n  return (\n    <Container>\n      {diagrams.map(diagram => <Diagram key={diagram._id} name={diagram._name} id={diagram._id} />)}\n    </Container>\n  )\n}\n\nDiagramList.defaultProps = {\n  diagrams: []\n}\n","import React from 'react'\nimport { Loading } from '../'\nimport styled from 'styled-components'\nimport { DiagramList } from './DiagramList'\n\nconst ListContainer = styled.div`\n  width: 600px;\n  padding: 12px;\n\n  @media only screen and (max-width: 767px) {\n    width: 100vw;\n    padding: 12px 0;\n  }\n`\n\nexport const DiagramBrowserView = props => {\n  const { diagrams, loading } = props\n\n  return (\n    <ListContainer>\n      {loading ? <Loading /> : <DiagramList diagrams={diagrams} />}\n    </ListContainer>\n  )\n}\n","import React, { useState, useEffect, useReducer, useCallback } from 'react'\nimport { Modal } from 'office-ui-fabric-react/lib/Modal'\nimport { useEvent } from '../../hooks'\nimport { Graph } from '../../util'\nimport { DiagramBrowserView } from './DiagramBrowserView'\n\nconst diagramReducer = (state, action) => {\n  switch (action.type) {\n    case 'loading':\n      return {\n        ...state,\n        loading: true\n      }\n    case 'success':\n      return {\n        ...state,\n        diagrams: action.diagrams,\n        loading: false\n      }\n    case 'failure':\n      return {\n        ...state,\n        loading: false,\n        error: action.error\n      }\n    default: return state\n  }\n}\n\nconst getDiagrams = async dispatch => {\n  dispatch({ type: 'loading' })\n  try {\n    const diagramsObject = await Graph.getDiagrams()\n    const diagrams = Object.values(diagramsObject).filter(diagram => !diagram._deleted)\n    dispatch({ type: 'success', diagrams })\n  } catch (error) {\n    dispatch({ type: 'failure', error })\n  }\n}\n\nexport const DiagramBrowser = props => {\n  const [isOpen, setIsOpen] = useState(false)\n  const [current, dispatch] = useReducer(diagramReducer, { diagrams: [], loading: true })\n\n  const openDiagramBrowser = useCallback(() => {\n    setIsOpen(true)\n  }, [setIsOpen])\n\n  const closeDiagramBrowser = useCallback(() => {\n    setIsOpen(false)\n  }, [setIsOpen])\n\n  const handleDiagramDeletion = useCallback(() => {\n    if (isOpen) {\n      getDiagrams(dispatch)\n    }\n  }, [isOpen, dispatch])\n\n  useEvent('open-diagram-browser', openDiagramBrowser)\n  useEvent('diagram-deleted', handleDiagramDeletion)\n\n  useEffect(() => {\n    if (isOpen) {\n      getDiagrams(dispatch)\n    }\n  }, [isOpen, dispatch])\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onDismiss={closeDiagramBrowser}\n    >\n      <DiagramBrowserView\n        diagrams={current.diagrams}\n        loading={current.loading}\n      />\n    </Modal>\n  )\n}\n","import React, { useReducer, useEffect, useCallback } from 'react'\nimport { Text } from 'office-ui-fabric-react/lib/Text'\nimport styled from 'styled-components'\nimport { useEvent } from '../../hooks'\nimport { Graph } from '../../util'\n\nconst Container = styled.div.attrs(props => ({\n  display: props.title ? 'flex' : 'none'\n}))`\n  position: absolute;\n  top: 60px;\n  right: 16px;\n  display: ${({ display }) => display};\n  align-items: flex-start;\n  justify-content: center;\n  padding: 8px 12px 8px 8px;\n  background-color: white;\n  border-radius: 2px;\n  box-shadow: 0 3px 5px #30303030;\n  z-index: 10;\n\n  @media only screen and (max-width: 767px) {\n    display: none;\n  }\n`\n\nconst titleReducer = (state, action) => {\n  switch (action.type) {\n    case 'loading':\n      return {\n        ...state,\n        loading: true\n      }\n    case 'success':\n      return {\n        ...state,\n        title: action.title,\n        loading: false\n      }\n    case 'failure':\n      return {\n        ...state,\n        loading: false,\n        error: action.error\n      }\n    default: return state\n  }\n}\n\nconst getTitle = async (dispatch) => {\n  dispatch({ type: 'loading' })\n  try {\n    const title = await Graph.getTitle()\n    dispatch({ type: 'success', title })\n  } catch (error) {\n    dispatch({ type: 'failure', error })\n  }\n}\n\nexport const DiagramTitle = props => {\n  const [current, dispatch] = useReducer(titleReducer, {})\n\n  const updateTitle = useCallback(() => {\n    getTitle(dispatch)\n  }, [dispatch])\n\n  useEffect(() => {\n    updateTitle()\n  }, [updateTitle])\n\n  useEvent('graph-data-updated', updateTitle)\n\n  return current.loading ? null : (\n    <Container title={current.title} >\n      <Text variant='xLarge'>{current.title}</Text>\n    </Container>\n  )\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Wrapper = styled.div.attrs(props => ({\n  sideSize: props.sidebarSize >= 0 ? props.sidebarSize : 200\n}))`\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: 44px 1fr;\n  grid-template-areas:\n    'header'\n    'content';\n  background-color: #ffffff;\n`\n\nconst HeaderContainer = styled.header`\n  grid-area: header;\n  background-color: blue;\n`\n\nconst Header = props => {\n  const { children, className } = props\n  return <HeaderContainer className={className}>{children}</HeaderContainer>\n}\n\nconst SidebarContainer = styled.section`\n  grid-area: sidebar;\n`\n\nconst Sidebar = props => {\n  const { children, className } = props\n  return <SidebarContainer className={className}>{children}</SidebarContainer>\n}\n\nconst ContentContainer = styled.section`\n  grid-area: content;\n  overflow: auto;\n`\n\nconst Content = props => {\n  const { children, className } = props\n  return <ContentContainer className={className}>{children}</ContentContainer>\n}\n\nconst FooterContainer = styled.footer`\n  grid-area: footer;\n`\n\nconst Footer = props => {\n  const { children, className } = props\n  return <FooterContainer className={className}>{children}</FooterContainer>\n}\n\nexport const Layout = props => {\n  const { children, sidebarSize, className } = props\n  return (\n    <Wrapper sidebarSize={sidebarSize} className={className}>\n      {children}\n    </Wrapper>\n  )\n}\n\nLayout.Header = Header\nLayout.Sidebar = Sidebar\nLayout.Content = Content\nLayout.Footer = Footer\n","import React from 'react'\nimport styled from 'styled-components'\nimport { DiagramForm, DiagramBrowser, DiagramTitle, SystemsGraph, NodeDetail, SystemForm, CommandBar, Layout } from './components'\n\nconst { Header, Content } = Layout\n\nconst Page = styled(Layout)`\n  height: 100vh;\n`\n\nconst GraphArea = styled(Content)`\n  background-color: #e8e3db;\n`\n\nfunction App () {\n  return (\n    <Page\n      sidebarSize={0}\n    >\n      <Header>\n        <CommandBar />\n      </Header>\n      <DiagramTitle />\n      <DiagramForm />\n      <DiagramBrowser />\n      <GraphArea>\n        <SystemsGraph />\n      </GraphArea>\n      <SystemForm />\n      <NodeDetail />\n    </Page>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { initializeIcons } from 'office-ui-fabric-react/lib/Icons'\nimport App from './App'\nimport './index.css'\n\ninitializeIcons()\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  render(<App />, document.getElementById('root'))\n})\n"],"sourceRoot":""}